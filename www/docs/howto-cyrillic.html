<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
<meta http-equiv="Content-Language" content="ru">
<meta name="copyright" content="Copyright (c) 2000-2005 by OpenBSD.ru">
<title>Русификация OpenBSD</title>
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<h2><font color="#e00000">Русификация OpenBSD</font></h2>
"Ибо без русификации читать кириллицу невозможно." Лебедев.
<hr>

<h4>Русификация OpenBSD</h4>

<ul>
  <li><a href="#wscons">Русификация консоли</a>
  <li><a href="#xwindow">Русификация X Window</a>
</ul>

<h4>Русификация программ</h4>

<ul>
  <li><a href="#fvwm">Fvwm</a> (Fvwm2, Fvwm95)
  <li><a href="#gtk">GTK приложений</a> (GIMP, Sylpheed, X-Chat и т.д.)
  <li><a href="#ksh">ksh</a>
  <li><a href="#LaTeX">LaTeX</a>
  <li><a href="#mg">mg</a>
  <li><a href="#readline">Readline приложений</a> (bash, mysql, psql, smbclient и т.д.)
  <li><a href="#samba">Samba</a>
  <li><a href="#twm">TWM - Tab Window Manager</a>
  <li><a href="#xterm">xterm</a>
</ul>

<hr>

<h2><font color="#e00000">Русификация OpenBSD</font></h2>

<h3><font color="#0000e0"><a name="wscons">Русификация консоли</a></font></h3>

<p>
Русификация консоли происходит в две стадии: смена раскладки клавиатуры и
настройка русских шрифтов.

<h4><font color="#008000">Раскладка клавиатуры</font></h4>

<p>
Добавьте в файл <code>/etc/wsconsctl.conf</code> раскладку вашей клавиатуры.
Если вы указали тип раскладки при установке системы, раскладка уже должна
стоять правильно. Также укажите тип переключателя раскладки.

<pre>
	keyboard.encoding=ru
	keyboard.map+="keycode 157 = Mode_Lock"
</pre>

<p>
В данном примере настраивается &quot;sticky&quot; переключение раскладок
клавишей правый Ctrl.

<h4><font color="#008000">Отображение кириллицы</font></h4>

<p>
Для отображения кириллицы необходимо загрузить шрифт и настроить
экраны (консоли).

<p>
На созданных ядром экранах кириллица отображаться не будет. Необходимо:

<ul>
  <li>либо удалить созданные по умолчанию экраны, загрузить шрифт и
  создать их заново;
  <li>либо пересобрать ядро с меньшим числом экранов по умолчанию
  (<code>option WSDISPLAY_DEFAULTSCREENS</code>), загрузить шрифт и
  создать новые.
</ul>

<p>
Экран ttyC0 создаётся всегда и не может быть удалён, поэтому на нем нельзя
отобразить кириллицу.

<p>
Исходя из количества экранов по умолчанию (в данном случае два), добавляем
в <code>/etc/rc.local</code> следующие строки для создания трёх дополнительных
экранов с предварительно загруженным русским шрифтом. При необходимости не
забудьте запустить на этих экранах дополнительные процессы <code>getty</code>,
см. ttys(5).

<pre>
	if [ -x /usr/sbin/wsconscfg -a -x /usr/sbin/wsfontload ]; then
		# загружаем русский koi8 шрифт
		wsfontload -h 16 /usr/share/misc/pcvtfonts/koi8-r-8x16
		# или украинский koi8 шрифт
		# wsfontload -h 16 /usr/share/misc/pcvtfonts/koi8-u-8x16

		for SCREEN in 2 3 5; do
			# удаляем экраны, созданные по умолчанию (для GENERIC)
			wsconscfg -d $SCREEN
			wsconscfg -t 80x25bf -e vt100 $SCREEN
		done
	fi
</pre>

<h3><font color="#0000e0"><a name="xwindow">Русификация X Window</a></font></h3>

<p>
В файл конфигурации X Window <code>/etc/X11/xorg.conf</code> в раздел
<strong>Section &quot;Files&quot;</strong> добавьте следующую строчку
<em>перед</em> ранее написанными директивами <strong>FontPath</strong>:

<pre>
	FontPath "/usr/X11R6/lib/X11/fonts/cyrillic/"
</pre>

<p>
Также для управления шрифтами используется fontconfig, позволяющий
использовать такие свойства TrueType шрифтов как антиалиасинг и хинтинг.
Это средство широко используется в программах на основе тулкитов
Gtk+ 2.x и Qt. Поэтому рекомендуется установить порт
<font color="#008000">/usr/ports/x11/msttcorefonts</font>, содержащий
бесплатные шрифты от Microsoft. Далее запустите программу обновления
кэша fontconfig:

<pre>
	# <strong>fc-cache</strong>
</pre>

<p>
Результат работы можно посмотреть, вызвав <code>fc-list</code>.

<p>
После перезагрузки X Window вы сможете читать тексты на русском языке в
кодировке koi8-r.

<p>
Для возможности ввода кириллицы следует настроить <code>xkb</code>.

<h4><font color="#008000">Настройка xkb</font></h4>

<p>
Для того, чтобы настроить <code>xkb</code>:

<p>
В Xorg необходимо добавить следующие строки в секцию
<strong>InputDevice</strong> файла <code>/etc/X11/xorg.conf</code>:

<pre>
	Option	"XkbRules"   "xfree86"
	Option	"XkbModel"   "pc105"
	Option	"XkbLayout"  "us,ru(winkeys)"
	Option	"XkbOptions" "grp_led:scroll,grp:ctrl_shift_toggle"
</pre>

<p>
Эти настройки можно сделать в удобной графической утилите <code>xorgcfg</code>
в разделе <strong>Keyboard</strong>.

<p>
В данном примере режим переключается комбинацией клавиш Ctrl+Shift.
При переключении раскладки будет загораться Scroll Lock (если задан
параметр grp_led).

<p>
Также необходимо определить несколько переменных окружения. Этого можно достичь,
добавив в файл <code>~/.xsession</code> (или <code>~/.xinitrc</code>):

<pre>
	export LC_COLLATE=C LC_CTYPE=ru_RU.KOI8-R LC_MONETARY=C \
		LC_NUMERIC=C LC_TIME=C
</pre>

<p>
Более подробную информацию по настройке xkb можно получить
<a href="http://www.tsu.ru/~pascal/other/xkb">здесь</a>.

<h2><font color="#e00000"><a name="programs">Русификация программ</a></font></h2>

<h3><font color="#0000e0"><a name="fvwm">Fvwm (Fvwm2 и Fvwm95)</a></font></h3>

<p>
Чтобы включить поддержку русских букв в менеджерах семейства fvwm, нужно
указать шрифты &quot;cronyx&quot; в следующих строчках конфигурационного
файла (<code>.fvwmrc</code>, <code>.fvwm2rc</code>, <code>.fvwm95rc</code>):

<pre>
	WindowFont -cronyx-helvetica-bold-r-*-*-12-*-*-*-*-*-*-*
	MenuFont -cronyx-helvetica-medium-r-*-*-12-*-*-*-*-*-*-*
	*FvwmPagerFont -cronyx-helvetica-bold-r-*-*-10-*-*-*-*-*-*-*
	*FvwmButtonsFont -cronyx-helvetica-bold-r-*-*-10-*-*-*-*-*-*-*
	*MiniButtonsFont -cronyx-helvetica-bold-r-*-*-10-*-*-*-*-*-*-*
	*FvwmIdentFont -cronyx-helvetica-medium-r-*-*-12-*-*-*-*-*-*-*
	*FvwmWinListFont -cronyx-helvetica-bold-r-*-*-10-*-*-*-*-*-*-*
	*FvwmTaskBarFont -cronyx-helvetica-medium-r-*-*-*-120-*-*-*-*-*-*
	*FvwmTaskBarSelFont -cronyx-helvetica-bold-r-*-*-*-120-*-*-*-*-*-*
</pre>

<h3><font color="#0000e0"><a name="gtk">Приложений на базе GTK</a></font></h3>

<p>
Все приложения на базе GTK (GIMP, Sylpheed, X-Chat и другие) можно
русифицировать, добавив в <code>~/.gtkrc</code> следующие строчки:

<pre>
	style "user-font"
	{
		font = "-cronyx-helvetica-*-r-normal-*-12-*-*-*-*-*-koi8-r"
	}

	widget_class "*" style "user-font"
</pre>

<h3><font color="#0000e0"><a name="ksh">ksh</a></font></h3>

<p>
Для того, чтобы была возможность вводить кириллицу в <code>ksh</code>,
необходимо добавить следующую команду в <code>~/.profile</code>:

<pre>
	set +o emacs-usemeta
</pre>

<h3><font color="#0000e0"><a name="LaTeX">LaTeX</a></font></h3>

<p>
Для того, чтобы документы могли содержать русские буквы, необходимо подключить
пакет русификации и указать кодировку в <em>преамбуле</em> документа. Например:

<pre>
	\documentclass{article}
	\usepackage[koi8-r]{inputenc}
	\usepackage[russian]{babel}
	\begin{document}
	\LaTeX~--- макропакет, позволяющий авторам верстать и печатать их работы
	с высоким типографским качеством при помощи заранее определённых,
	профессиональных макетов.
	\end{document}
</pre>

<p>
Для того, чтобы активизировать переносы в русских словах, запустите утилиту
<code>texconfig</code>, выберите раздел <strong>hyphenation</strong>,
далее <strong>latex</strong> и раскомментируйте строку:

<pre>
	russian ruhyphen.tex
</pre>

<h3><font color="#0000e0"><a name="mg">mg - emacs-like text editor</a></font></h3>

<p>
Чтобы заставить mg работать с русскими буквами, достаточно создать файл
<code>~/.mg</code>, содержащий строчку:

<pre>
	meta-key-mode
</pre>

<h3><font color="#0000e0"><a name="readline">Readline приложений</a></font></h3>

<p>
Приложения на базе readline (bash, mysql, psql, smbclient и т.д.) могут
работать с русскими буквами. Для этого необходимо создать файл
<code>~/.inputrc</code>, содержащий следующие строки:

<pre>
	set convert-meta off
	set input-meta on
	set output-meta on
</pre>

<h3><font color="#0000e0"><a name="samba">Samba</a></font></h3>

<p>
Для того, чтобы Windows клиенты видели русские буквы, в файл
<code>/etc/samba/smb.conf</code> в секцию <code>[global]</code>
необходимо добавить следующие строки:

<p>
Если используется samba 3.x:

<pre>
	dos charset = cp866
	unix charset = koi8-r
</pre>

<p>
Если используется samba 2.x:

<pre>
	client code page = 866
	character set = koi8-r
</pre>

Для того, чтобы в <strong>smbclient</strong> можно было вводить
русские буквы, необходимо создать файл <code>~/.inputrc</code>,
как это описано в разделе, посвящённом русификации
<a href="#readline">Readline</a> приложений.

<h3><font color="#0000e0"><a name="twm">Tab Window Manager</a></font></h3>

<p>
Для того, чтобы Menu, Title и IconManager в TWM писали по-русски, необходимо
изменить следующие строчки в <code>~/.twmrc</code> (помимо остальной
конфигурации TWM). Пример настройки TWM можно посмотреть
<a href="../files/home/twmrc">тут</a>.

<pre>
	TitleFont "-cronyx-helvetica-medium-r-normal-*-12-*-*-*-*-*-koi8-r"
	MenuFont "-cronyx-helvetica-medium-r-normal-*-12-*-*-*-*-*-koi8-r"
	IconManagerFont "-cronyx-helvetica-medium-r-normal-*-12-*-*-*-*-*-koi8-r"
</pre>

<h3><font color="#0000e0"><a name="xterm">xterm</a></font></h3>

<p>
Начиная с версии OpenBSD 4.2 <code>xterm</code> поставляется из исходного кода
<em>xenocara</em>. Для возможности ввода и вставки из буфера кириллицы
необходимо при запуске <code>xterm</code> указывать опцию <code>-k8</code>:

<pre>
	% <strong>xterm -k8</strong>
</pre>


<p>
<hr>
<a href="index.html"><img height=24 width=24 src="../images/back.gif" border=0 alt="OpenBSD.ru"></a>
<a href="mailto:www@openbsd.ru">www@openbsd.ru</a>
<br>
<small>$RuOBSD: howto-cyrillic.html,v 1.84 2007/11/09 12:07:32 mkb Exp $</small>

</body>
</html>
