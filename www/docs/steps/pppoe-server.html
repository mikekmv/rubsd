<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
<meta http-equiv="Content-Language" content="ru">
<meta name="copyright" content="Copyright (c) 2006 by OpenBSD.ru">
<title>Настройка PPPoE-сервера</title>
<link rel="stylesheet" href="css/style.css" type="text/css">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<h2><font color="#e00000">Настройка PPPoE-сервера</font></h2>
<hr>

<h3><font color="#0000e0">Мини-руководство "шаг за шагом"</font></h3>

<p>
<table border=0>
<tr><td>

<p>
Пример создания PPPoE-сервера. Предположим, vr0 - это сетевой интерфейс,
на котором будет работать сервер.

<p>
Перейдем к настройке PPP. Обратите внимание, что в файле
<font color="#008000">/etc/ppp/ppp.conf</font> cтроки, оканчивающиеся на
``:'', вводятся без отступа в начале строки. Остальные строки должны быть
введены с отступом, как показано в примере.

<pre>
# <strong>vi /etc/ppp/ppp.conf</strong>
default:
  Set log Phase Chat LCP IPCP CCP tun command
  Disable ipv6cp

pppoe1:
  set device "!/usr/sbin/pppoe -i vr0"
  set mtu max 1492
  set mru max 1492
  set speed sync
  disable acfcomp protocomp
  deny acfcomp
  set ifaddr 192.168.1.1 192.168.1.32-192.168.1.63 255.255.255.255
  enable chap
</pre>

<p>
Создание или изменение учетных записей пользователей производится за счет
редактирования файла <font color="#008000">/etc/ppp/ppp.secret</font>. Если
IP-адрес должен быть динамическим, тогда вместо поля <tt>ip_address</tt>
нужно поставить знак звездочки (``*''). Поле <tt>label</tt> является
необязательным. Например:

<pre>
# <strong>vi /etc/ppp/ppp.secret</strong>
#user   password        ip_address      label
user1   secret123       192.168.1.40    sidorov
user2   123qwe          *
</pre>

<p>
Выставляем корректные права доступа:

<pre>
# <strong>chmod 600 /etc/ppp/ppp.{conf,secret}</strong>
</pre>

<p>
Запуск:

<pre>
# <strong>pppoe -p pppoe1 -i vr0 -s &</strong>
</pre>

<p>
Если тестирование прошло успешно, можно настроить автоматический запуск при
старте системы:

<pre>
# <strong>vi /etc/rc.local</strong>
/usr/sbin/pppoe -p pppoe1 -i vr0 -s &amp; &gt;/dev/null 2&gt;&amp;1
</pre>

<p>
Статья основана на материалах, предоставленных Гнединым Алексеем aka Goblin.

</td></tr>
</table>

<p>
<hr>
<a href="index.html"><img height=24 width=24 src="../../images/back.gif" border=0 alt="OpenBSD.ru"></a>
<a href="mailto:www@openbsd.ru">www@openbsd.ru</a>
<br>
<small>$RuOBSD: pppoe-server.html,v 1.2 2006/02/09 13:24:35 andrey Exp $</small>

</body>
</html>
