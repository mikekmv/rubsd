<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
<meta http-equiv="Content-Language" content="ru">
<meta name="copyright" content="Copyright (c) 2000-2006 by OpenBSD.ru">
<title>Sendmail: Поддержка Maildir с помощью Procmail</title>
<link rel="stylesheet" href="css/style.css" type="text/css">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<h2><font color="#e00000">Sendmail: Поддержка Maildir с помощью Procmail</font></h2>
<hr>

<h3><font color="#0000e0">Мини-руководство "шаг за шагом"</font></h3>

<p>
<table border=0>
<tr><td>

<blockquote>
<p>
Устанавливаем procmail из портов:

<pre>
# <strong>cd /usr/ports/mail/procmail</strong>
# <strong>make install clean</strong>
</pre>

<p>
Или с помощью прекомпилированного пакета:

<pre>
# <strong>pkg_add ftp://ftp.openbsd.org/pub/OpenBSD/3.8/packages/i386/procmail-3.22p0.tgz</strong>
</pre>

<p>
Редактируем главный конфигурационный файл procmail:

<pre>
# <strong>vi /etc/procmailrc</strong>

# Секция общих настроек.
#
DROPPRIVS=yes
COMSAT=no
VERBOSE=off
SHELL=/bin/sh
PATH=/bin:/usr/bin:/usr/local/bin
LOCKFILE=$HOME/.lockmail
LOGFILE=$HOME/procmail.log

# Складываем почту в формате Maildir.
#
MAILDIR=$HOME/Maildir/
DEFAULT=$MAILDIR

# Входящую корреспонденцию можно резервировать в файлы формата mbox.
#
#:0 c
#/var/mail/$LOGNAME

# Либо передавать в хранилище на другом хосте.
#
#:0 c
#! mail@mx2.domain.ru
</pre>

<p>
Переходим в каталог с примерами конфигурационных mc-файлов:

<pre>
# <strong>cd /usr/share/sendmail/cf</strong>
</pre>

<p>
Изменяем локальный агент доставки почты с mail.local на procmail:

<pre>
# <strong>vi server.mc</strong>
FEATURE(local_procmail)dnl
MAILER(local)dnl
MAILER(smtp)dnl
</pre>

<p>
Пересобираем mc-файл, предварительно сделав копию исходного sendmail.cf:

<pre>
# <strong>cp /etc/mail/sendmail.cf /etc/mail/sendmail.cf.bak</strong>
# <strong>m4 ../m4/cf.m4 server.mc > /etc/mail/sendmail.cf</strong>
</pre>

<p>
Запускаем sendmail:

<pre>
# <strong>/usr/sbin/sendmail -L sm-mta -bd -q30m</strong>
</pre>

<p>
Либо заставляем демона перечитать свой cf-конфиг:

<pre>
# <strong>kill -HUP `head -1 /var/run/sendmail.pid`</strong>
</pre>
</blockquote>

</td></tr>
</table>

<p>
<hr>
<a href="index.html"><img height=24 width=24 src="../../images/back.gif" border=0 alt="OpenBSD.ru"></a>
<a href="mailto:www@openbsd.ru">www@openbsd.ru</a>
<br>
<small>$RuOBSD: procmail.html,v 1.5 2005/12/31 11:27:01 andrey Exp $</small>

</body>
</html>
