<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>4 - OpenBSD 3.3 Руководство по установке</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=KOI8-R">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2003 by OpenBSD.">
</head>

<!-- Passes validator.w3.org.  Please keep it this way -->

<body bgcolor= "#ffffff" text= "#000000">

<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif">
<p>

<font color= "#0000e0">
<a href= "index.html">[Содержание]</a>
<a href= "faq3.html">[Раздел 3 - Получение OpenBSD]</a>
<a href= "faq5.html">[Раздел 5 - Сборка системы из исходников]</a>
</font>

<h1><font color="#e00000">4 - Руководство по установке OpenBSD 3.3</font></h1>
<hr>

<p>
<h3>Содержание</h3>
<ul>
<li><a href= "#Overview"    >4.1 - Обзор процедуры установки</a>
  <ul>
  <li><a href="#Plats"      >4.1.1 - Поддерживаемые архитектуры</a>
  <li><a href="#Media"      >4.1.2 - Поддерживаемые носители для инсталяции</a>
  <li><a href="#MkFlop"     >4.1.3 - Создание загрузочных инсталляционных дискет OpenBSD</a>
    <ul>
    <li><a href="#UnixFlop"  >4.1.3.1 - Создание дискет в Unix</a>
    <li><a href="#DosFlop"   >4.1.3.2 - Создание дискет в DOS/Windows</a>
    </ul>
  <li><a href="#Boot"       >4.1.4 - Загрузка исталляционных образов OpenBSD</a>
  </ul>
<li><a href= "#Checklist"   >4.2 - Перед тем как начать</a>
<li><a href= "#Install"     >4.3 - Инсталляция</a>
  <ul>
  <li><a href="#Disks"      >4.3.1 - Разбиение дисков в процессе инсталляции</a>
  <li><a href="#Hostname"   >4.3.2 - Установки имени хоста</a>
  <li><a href="#Network"    >4.3.3 - Настройка сети</a>
  <li><a href="#InstMedia"  >4.3.4 - Выбор носителя для инсталляции</a>
  <li><a href="#Filesets"   >4.3.5 - Выбор пакетов для установки</a>
  <li><a href="#SmallRAM"   >4.3.6 - Дополнительные шаги на машинах с малым объемом оперативной памяти</a>
  <li><a href="#Finish"     >4.3.7 - Завершение инсталляции</a>
  <li><a href="#OtherInf"   >4.3.8 - Другие ресурсы</a>
  </ul>

<li><a href= "#FilesNeeded" >4.4 - Какие файлы нужны для инсталляции?</a>
<li><a href= "#SpaceNeeded" >4.5 - Сколько места нужно для инсталляции OpenBSD?</a>
<li><a href= "#Multibooting">4.6 - OpenBSD в мультизагрузочной среде</a>
<li><a href= "#SendDmesg"   >4.7 - Отсылка dmesg по адресу dmesg@openbsd.org после инсталляции</a>
<li><a href= "#AddFileSet"  >4.8 - Добавление инсталляционных пакетов после инсталляции</a>
<li><a href= "#bsd.rd"      >4.9 - Что такое 'bsd.rd'?</a>
<li><a href= "#InstProb"   >4.10 - Общие проблемы инсталляции</a>
  <ul>
  <li><a href="#mkdevhang" >4.10.1 - Инсталляция "зависла" на MAKEDEV</a>
  <li><a href="#cpq16m"    >4.10.2 - На моем Compaq определяется только 16M ОЗУ</a>
  <li><a href="#noboot"    >4.10.3 - Мой i386 не хочет грузиться после инсталляции</a>
  <li><a href="#sshhang"   >4.10.4 - Мой компьютер грузится, но "зависает" во времеся процесса  ssh-keygen</a>
  <li><a href="#noftplist" >4.10.5 - Я получил сообщение "ftplist: No such file" во время инсталляции</a>
  </ul>
<li><a href= "#site"       >4.11 - Customizing the Install Process</a>
<li><a href= "#Multiple"   >4.12 - Как я могу установить несколько систем?</a>
<li><a href="#getdmesg"    >4.13 - Как я могу получить dmesg(8) для того, чтобы сообщить о проблеме?</a>
</ul>
<hr>

<p>
<a name= "Overview"></a>
<h2>4.1 - Обзор процедуры установки</h2>

<p>
OpenBSD имеет очень надежную и гибкую процедуру инсталляции, использующую в текстовой режим.
Сама исталляция может быть произведена с помощью одной дискеты. Большинство архитектур имеют аналогичные 
процедуры инсталляции, различающиеся в деталях. В любом случае Вам необходимо ознакомиться с соответвующем платформе
документом, начинающимся с имени INSTALL с последующимся префиксом (например, <tt>INSTALL.i386</tt>,
<tt>INSTALL.mac68k</tt> или <tt>INSTALL.sparc</tt>), который находится в соответствующем платформе каталоге на CDROM или FTP.

<p>
На большинстве архитектур существует несколько способов инсталляции,
включая инсталляцию с FTP, CDROM или с локального диска. 
<a href="faq3.html#ISO">Скачивание ISO-образов</a> с последующим созданием
копии официального CDROM является единственной неподдерживаемой услугой.
Если вы хотите получить официальный CDROM, вы можете его <a href="../orders.html">купить</a>.
Если ваша система не поддерживает загрузку с дискеты, вы можете воспользоваться загрузочным инсталляционным 
образом для CDROM (<tt>cd33.iso</tt>). Следует отметить, что этот
загрузочный образ не содержит инсталляционных пакетов, так что их все равно придется скачивать с FTP,
или воспользоваться другими доступными в процессе инсталляции средствами.

<a name="Plats"></a>
<h3>4.1.1 - Поддерживаемые архитектуры</h3>
<!-- XXXrelease -->
<!-- XXXversion -  Lots of places. -->

<p>
OpenBSD 3.3 поддерживает несколько архитектрур, список которых представлен ниже в алфавитном порядке.
Дополнительная информация доступна на страницах, посвещенных соотвествующим архитектурам.

<ul>
  <li><a href="../alpha.html">alpha</a> - Компьютеры на базе DEC Alpha.
  <li><a href="../hp300.html">hp300</a> - Компьютеры на базе Hewlett-Packard HP300/HP400.
  <li><a href="../hppa.html">hppa</a> - Компьютеры на базе HP PA-RISK <i>*новинка в 3.3*</i>
  <li><a href="../i386.html">i386</a> - Intel i386 и совместимые.
  <li><a href="../mac68k.html">mac68k</a> - Большинство моделей Apple  Macintosh на базе MC680x0.
  <li><a href="../mvme68k.html">mvme68k</a> - Карты Motorola MVME147/16x/17x 68K VME.
  <li><a href="../macppc.html">macppc</a> - Поддержка систем Apple на базе PowerPC.
  <li><a href="../sparc.html">sparc</a> - Платформа SPARC Platform от Sun Microsystems.
  <li><a href="../sparc64.html">sparc64</a> - Системы Sun UltraSPARC. 
  <li><a href="../vax.html">vax</a> - Компьютеры DEC VAX.
</ul>

<a name="Media"></a>
<h3>4.1.2 - Поддерживаемые носители для инсталяции </h3>

<p>
OpenBSD может быть установлен с различных типов носителей. Самые распространенные и
архитектурнонезависимые представлены ниже. Их можно использовать при загрузке с CD-ROM,
дискеты или <a href="#bsd.rd">ядра с поддержкой виртуальных дисков</a>.

<p>
<table align="center" border="1" width="600">
<tr>
	<td>
		<b>CD-ROM</b>
	</td>
	<td bgcolor="#EEEEEE">
		Чтобы установить сисстему с CD-ROM, Вы должны приобрести
		<a href="../orders.html">официальный CD-ROM с OpenBSD</a> или
		сделать CD-ROM самостоятельно. Как правило, это наиболее
		простой способ установить систему. <br>
		<b>ПОМНИТЕ:</b> Вы можете загрузиться с официального CD, если Ваш 
		компьютерр поддерживает загрузку с CD-ROM.
	</td>
</tr><tr>
	<td>
		<b>FTP</b>
	</td>
	<td bgcolor="#EEEEEE">
		Данный способ позволяет установить OpenBSD, используя сетевое 
		соединение для скачивания необходимых пакетов.
	</td>
</tr><tr>
	<td>
		<b>Локальная файловая система</b>
	</td>
	<td bgcolor="#EEEEEE">
		Данный способ позволяет установить систему, ранее сахраненные 
		пакеты на существующей файловой системе. Инсталляционный диск 
		для архитектуры i386 поддерживает DOS, EXT2FS и FFS. 
	</td>
</tr>
</table>

<a name="MkFlop"></a>
<h3>4.1.3 - Создание загрузочных инсталляционных дискет OpenBSD</h3>

<p>
Чтобы создать инсталляционную дискету, Вы должны скачать загрузочный образ 
дискеты с одного из сайтов, где есть нужная Вам версия OpenBSD или найти 
соответствующий образ на официальном CD-ROM.
Список FTP-серверов, откуда можно скачать OpenBD находится <a href="../ftp.html">здесь</a>.
Для большинства архитектур существует один или несколько инсталляционных образов для различных
аппаратных конфигурация. Отличия в инсталляционных образах для платформ i386 буду обозначны ниже.
Для остальных архитектур обратитесь к соответвующим файламм INSTALL на FTP или CD-ROM.
Для архитектур с обной инсталляционной дискетой, просто скачайте соответсвующий образ с именем
<tt>floppy33.fs</tt>.

<p>
Платформа <a href="../i386.html">i386</a> имеет пять различных образов 
инсталляционных дисков:

<ul>
<li><b><tt>floppy33.fs</tt></b> (для настолных PC) поддерживает различные
	сетевые карты PCI и ISA, IDE и простых SCSI адаптеров, а также некотороые PCMCIA
	устройства.
<li><b><tt>floppyB33.fs</tt></b> (для серверов) поддерживает различные RAID контроллеры,
	и некоторые менее распространенные SCSI адаптеры. Поддержка для большинства
	стандартных адаптеров SCSI, сетевых карт EISA и ISA отсутствует.
<li><b><tt>floppyC33.fs</tt></b> (для лаптопов) поддерживает устройства Cardbus и PCMCIA,
	присутствующие на большинстве лаптопов.          
<li><b><tt>cdrom33.fs</tt></b> представляет собой комбинацию трех предыдущих дисков.
	Может быть использован для создания загрузочного диска объемом 2.88M или
	для собственного загрузочного CD.
<li><b><tt>cd33.iso</tt></b> представляет собой образ загрузочного CD-ROM в формате ISO9660.
	Загрузочный инсталляционный CD-ROM может быть создан с помощью популярного программного
	обеспечения для записи CD.
</ul>

<p>
Большинству пользователей i386 подойдет загрузочный образ с именем
<tt>floppy33.fs</tt>.

<p>
Существуют ситуации, когда пользователю необходима, например, поддержка SCDI адаптера с одного диска
и сетевой карты с другого. Такая ситуация возникает достаточно редко и ее можно обойти. 

<p>
После того как Вы выбрали нужный диск, Вам необходима чистая дискета.
Если на дискете будет хоть один плохой сектор, инсталляция, скорее всего, завершиться неудачей.

<p>
<a name="UnixFlop"></a>
<h4>4.1.3.1 - Создание дискет в Unix.</h4>
Для того, чтобы отформатировать дискету, воспользуйтесь коммандой
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdformat&amp;sektion=1&amp;arch=i386">fdformat(1)</a>
для форматирования и проверки на наличие плохих секторов.

<p>
<table border=0 width="650"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  # <b>fdformat /dev/rfd0c</b>
  Format 1440K floppy `/dev/rfd0c'? (y/n): y
  Processing VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV done.
</pre></td></tr> </table>

<p>
Если вы увидите нечто похожее на пример, значит Ваш диск в порядке. 
В противном случае диск скорее всего плохой и Вам нужно попробовать другой.

<p>
Теперь, когда у вас есть отформатированная дискета, настало время создать загрузочный
диск. Для этого воспользуйтесь утилитой
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=0">dd(1)</a>
.  Пример использования <tt>dd(1)</tt> представлен ниже:

<p>
<table border=0 width="650"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  # <b>dd if=floppy33.fs of=/dev/rfd0c bs=32k</b>
</pre></td></tr></table>

<p>
После того как образ записался необходимо произвести проверку с помощью команды
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cmp&amp;sektion=1">cmp(1)</a>.
Если дисткета соответсвует образу, то Вы увидите командную строку.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>cmp /dev/rfd0c floppy33.fs</b>
</pre></td> </tr> </table>

<a name="DosFlop"></a>
<h4>4.1.3.2 - Создание дискет в DOS/Windows.</h4>
Если Вы будете создавать загрузочный диск на платформе Windows/DOS
Вам необходимо скачать упомянутые ниже утилиты из каталога
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/tools/">tools</a>
на FTP или зеркале, или из каталога <tt>3.3/tools</tt> на диске
CD1 официального CD OpenBSD.  Пользователи DOS/Windows 9x, могут
воспользоваться утилитой <i>rawrite</i> для записи диска.

<p>
Для подготовки дискеты Вы можете воспользоваться штатными средствами 
MS-DOS или Windows. 

<p>
To write the installation image to the prepared floppy you can use
<i>rawrite</i>, <i>fdimage</i>, or <i>ntrw</i>. <i>rawrite</i> will not
work on Windows NT, 2000 or XP.

<p>
Помните, что <tt>FDIMAGE.EXE</tt> и <tt>RAWRITE.EXE</tt> это программы 
MS-DOS, что накладывает ограничение на длину имени файла в формате "8.3".
Так как <tt>floppy33B.fs</tt> и <tt>floppy33C.fs</tt> имеют имена больше 8 
символов, перед тем как воспользоваться <tt>FDIMAGE.EXE</tt> или
<tt>RAWRITE.EXE</tt> вы должны найти их под теми именами, под которыми они 
были сохранены системой.

<p>
Пример использования <i>rawrite</i>:
<table border=0 width="650"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <b>rawrite</b>
  RaWrite 1.2 - Write disk file to raw floppy diskette

  Enter source file name: <b>floppy33.fs</b>
  Enter destination drive: <b>a</b>
  Please insert a formatted diskette into drive A: and press -ENTER- : <i><b>Enter</b></i>
</pre> </td> </tr> </table> 

<p>
Пример использования <i>fdimage</i>:
<table border=0 width="650"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <strong>fdimage -q floppy33.fs a:</strong>
</pre></td></tr></table>

<p>
Пример использования <i>ntrw</i>:
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <strong>ntrw floppy33.fs a:</strong>
  3.5", 1.44MB, 512 bytes/sector
  bufsize is 9216
  1474560 bytes written
</pre></td></tr></table>

<a name="Boot"></a>
<h3>4.1.4 - Загрузка исталляционных образов OpenBSD.</h3>

<p>
Этот раздел разбит на несколько архитектурнозависимых секций для
наиболее популярных архитектур, поддерживаемых OpenBSD.
Это необходимо для того, чтобы проинформировать пользователей что
необходимо делать на каждой из архитектур.

<h4>Загрузка на i386</h4>

<p>
Загрузка инсталляционного образа на архитектуре i386
не имеет ничего нового для большинства людей. Если Вы используете дискету,
просто вставьте дискету в дисковод и перезагрузите компьютер. Инсталляционный образ
автоматически загрузится (при условии, что загрузка с дискеты разрешена в BIOS).
Если Вы планируете загрузиться с CD, вы должны пойти в настройки BIOS и разрешить 
загрузку с CD. Некоторые старые BIO не могут загруджаться с CD, м Вам придется 
воспользоваться дискетой. Однако не беспокойтесь, если Вы загрузитесь с дискеты, 
Вы все равно сможете поставить систему с CD-ROM.

<h4>Загрузка на sparc</h4>

<p>
<b>ПОМНИТЕ:</b> На sparc64, только машины с SBus (Ultra 1, Ultra 2)
могут загружаться с дискеты.

<p>
Для загрузки с дискеты поместите дискету с инталляционным образом в дисковод.
Затем введите следующую команду для загрузки:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot floppy</b>
</pre></td></tr></table>

<p>
Для загрузки с CD-ROM поместите CD-ROM в устройство для чтения CD-ROM.
Если система имеет один CD-ROM, просто наберите '<tt>boot cdrom</tt>' в приглашении:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot cdrom</b>
</pre></td></tr></table>

<p>
Конечно это команда будет работать только в том случае, если вы находитесь
новом режиме ввода команд. Если Вы находитесь в старом режиме (стрелка больше),
Вам необходимо переключиться с помощью команды 'n'. (На старых машинах, до sun4c,
Вы скорее всего не сможете переключиться. В этом случае Вам необходимо провести маленький эксперимент.)
Если на Вашей системе установлено несколько устройств для чтения CD-ROM,
Вам необходимо выбрать правильное устройство для загрузки. Попробуйте
воспользоваться командой <tt>probe-scsi</tt>.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>probe-scsi</b>

  Target 0
    Unit 0   Disk     QUANTUM LIGHTNING 365S
  Target 1
    Unit 0   Removable Disk     QUANTUM EMPIRE_1080S
  Target 3
    Unit 0   Removable Disk     Joe's CD ROMs
</pre></td></tr></table>

<p>
Выбеите устройство, с которого Вы хотите загрузиться. Запомните его номер.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot /sbus/esp/sd@X,0</b>
</pre></td></tr></table>

<p>

<a name="Checklist"></a>
<h2>4.2 - Перед тем как начать</h2>
Перед тем как начать установку, Вам необходимо собрать некоторую информацию о будущей системе.

Как минимум Вы должны знать/иметь:
<ul>
<li>Имя компьютера
<li>Список установленного и доступного для работы аппраратного обеспечения
  <ul>
  <li>Проверить что Ваше аппаратное обеспечение будет работать. Список совместимого 
	оборудования Вы можете найти на странице свместимости для соответствующей платформы
  <li>Для ISA-устройств Вы также должны знать аппаратные настройки и убедиться что они совпадают с требованиями
      OpenBSD.
  </ul>
<li>Способ установки системы (CDROM, FTP и т.п.)
<li>Желаемое разбиение диска
  <ul>
  <li>Нужно ли сохранить существующие данные где-нибудь еще?
  <li>Будет ли OpenBSD сосуществовать на диске с другой ОС? Если да, то как они будут загружаться?
	Нужно ли инсталльровать какой-нибудь загрузчик?
  <li>Будет ли OpenBSD использовать весь диск или только его часть?
  <li>Как Вы хотите разбить отведенное для OpenBSD место на отдельные разделы?
  </ul>
<li>Сетевые настройки, если Вы не будете использовать DHCP:
  <ul>
  <li>Имя домена
  <li>Имя сервера(-ов) доменных имен (DNS сервера(-ов))
  <li>IP адресс и маску сети для кажлдой сетевой платы
  <li>Адрес шлюза
  </ul>
<li>Планируете ли Вы запускать оконную среду X?
</ul>



<a name="Install"></a>
<h2>4.3 - Инсталляция</h2>
<!-- XXXrelease -->
Независимо от того, зачем вы загружали систему, пришло время использовать ее.
 Во впремя загрузки ядро системы и
все программы, используемые для инсталляции, загружаются в память.
Наиболее часто проблемы, которые возникают в этот период времени, 
связаны либо с плохой дискетой либо с проблемами с дисководом. 
Программны на инсталляционной
дискете упакованы поэтому любая ошибка на дискете может привести к проблемам.

<p>
Практически в любой точке инсталляции Вы можете прервать процесс,
нажав комбинацию кливиш Ctrl-C, и начать инсталляцию заново без перезагрузки,
набрав <tt>install</tt> в командной строке.

<p>
Если загрузка на Вашей системе пройдет успешно Вы увидите много текста на экране.
Этот текст (<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg</a>)
, который на многих архитектурах будет белым на синем фоне, является 
результатом загрузки ядра, которое сообщает о найденых устройствах.
Если он Вам понадобиться в дальнейшем, Вы можете найти его копию в файле
<tt>/var/run/dmesg.boot</tt>. На некоторых архитектурах Вы можете просмотреть
не поместившуюся на экран во время загрузки часть с помощью комбинации клавиш SHIFT+PGUP.

<p>
После загрузки ядра Вы увидите следущее:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  rootdev=0x1100 rrootdev=0x2f00 rawdev=0x2f02
  erase ^?, werase ^W, kill ^U, intr ^C, status ^T
  (I)nstall, (U)pgrade or (S)hell? <b>i</b>
</pre></td></tr></table>

<p>
Это означает, что Вы достигли начала инсталляции. В большинстве случаев
Вы увидите три варианта выбора:
<ul>
<li><b>Install:</b> Новая установка OpenBSD в системе с перезаписью всего, 
что было ранее. Следует отметить, что Вы можете оставить некоторые разделы,
такие как <tt>/home</tt> нетронутыми, но все остальное будет перезаписано.
<li><b>Upgrade:</b> Установка нового набора <a href="#FilesNeeded">инсталляционных
файлов</a> на Вашем компьютере, поверх существующих с сохранением файлов конфигурации,
данных пользователей и дополнительных программ. Существующие разделы не форматируются,
данные в каталогах /etc и /var не изменяются. После инсталляци Вы можете вручную
установить конфигурацию из файла <tt>etc33.tgz</tt>, внеся в новую конфигурацию
необходимые изменения. Это очень важный шаг, так как в противном случае некоторые
ключевые службы, (например, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">pf(4)</a>)
 могут не работать.
<br>
<b>ПОМНИТЕ:</b> Данный тип инсталляции не предназначен для пропуска релизов!
Хотя это часто работает, тем не менее такая операция не поддерживается. 
Поддерживается только последовательое обновление системы от версии к версии,
например от 3.2 к 3.3. Если Вы хотите произвести обновленее с более старой версии
Вам необходимо будет воспользоваться переустановкой "с нуля".
<li><b>Shell:</b> Иногда бывает необходимо провести некоторые погдотовительные шаги
перед инсталляцией. Данная опция позволяет Вам выйти в командный процессор чтобы произвести
некоторую подготовку к установке системы.
</ul>

В силу последних обстоятельств, Вы не увидите вариант "Upgrade". После
<a href="http://www.catb.org/~esr/jargon/html/entry/flag-day.html">часа Х</a>,
Вы больше не сможете напрямую обновить систему, Вы должны установить систему
заново. Это связано с тем, что на некоторых платформах, например OpenBSD/sparc,
 изменился формат исполняемых файлов с a.out на ELF в процессе разработки новой
версии после выхода 3.1 и до выхода 3.2. Пользователи SPARC, которые хотят обновить 
систему до 3.2 или 3.3 должны переустановить систему.

<p>
В нашем примере будет производиться установка системы, обновление производится аналогично.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Welcome to the OpenBSD/i386 3.3 install program.

  This program will help you install OpenBSD in a simple and rational way. At
  any prompt except password prompts you can run a shell command by typing
  '!foo', or escape to a shell by typing '!'. Default answers are shown in []'s
  and are selected by pressing RETURN. At any time you can exit this program by
  pressing Control-C and then RETURN, but quitting during an install can leave
  your system in an inconsistent state.

  Specify terminal type: [vt220]
  Do you wish to select a keyboard encoding table? [n] <b>y</b>
</pre></td></tr></table>

<p>
В большинстве случаев тип терминала по-умолчанию правилен для установки,
однако, если Вы используете для исталляции
<a href="faq7.html#SerCon">последовательную консоль</a> этого может быть не достаточно.

<p>
Если Вы не выберете раскладку клавиатуры, то по-умолчанию будет использоваться
американская (US).

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  IS YOUR DATA BACKED UP? As with anything that modifies disk contents, this
  program can cause SIGNIFICANT data loss.

  It is often helpful to have the installation notes handy. For complex disk
  configurations, relevant disk hardware manuals and a calculator are useful.

  Proceed with install? [n] <b>y</b>
</pre></td></tr></table>

<p>
Если Вы выберите  ответ по-умолчанию, то процесс установки завершится и Вы 
увидите командную строку.

<a name="Disks"></a>
<h3>4.3.1 - Разбиение дисков в процессе инсталляции.</h3>

<p>
Подготовка дисковых разделов в OpenBSD немного отличается в зависимости 
от платформы. Для платформ i386 и macppc, разбиение диска производится в 
2 этапа. Сначала определяется раздел для OpenBSD при помощи fdisk(8), 
затем этот участок делится на разделы с помощью disklabel(8).

<p>
Некоторых людей может смутить используемая терминология. В самом деле, кажется, 
что мы используем слово "раздел" в двух различных значениях. Это правильное наблюдение. 
На некоторых OpenBSD-платформах существует два слоя разбиения диска; первый слой (раздел) 
рассматривается как раздел уровня Операционных Систем, то есть касается того, 
как различные операционные системы на одном компьютере обозначают свое место 
на диске компьютера, и второй, касающийся того, как раздел OpenBSD разбит 
на отдельные файловые системы.  Первый слой виден для других операционных 
систем как участок на диске, и любая другая операционная система может  
работать с другими операционными системами на IBM AT-совместимых машинах. 
Второй слой разделения виден только самой OpenBSD и тем операционным системам, 
которые умеют читать с файловой системы OpenBSD.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Cool!  Let's get to it...

  You will now initialize the disk(s) that OpenBSD will use. To enable all
  available security features you should configure the disk(s) to allow the
  creation of separate filesystems for /, /tmp, /var, /usr, and /home.

  Available disks are: wd0.
  Which one is the root disk? (or done) [wd0] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Корневой диск это диск с которого система будет грузиться, и, обычно, это диск, 
на котором размещается файл подкачки. Чаще всего нужно выбрать значение по умолчанию,
 если нет, то Вам следовало бы знать, как заставить ваш компьютер грузиться с 
нестандартного диска. Диски IDE будут показаны как wd0, wd1 и так далее, 
SCSI диски и устройства RAID - как sd0, sd1 и далее. Все диски, которые OpenBSD 
смогла найти, показаны здесь, если у Вас есть диски, которые не показаны здесь, 
то это неподдерживаемое или неправильно сконфигурированное аппаратное обеспечение.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you want to use *all* of wd0 for OpenBSD? [no] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Если Вы ответите "yes" на этот вопрос, весь жесткий диск будет использован под OpenBSD. 
В результате Вы получите Master Boot Record и таблицу разбиения разделов - 
один раздел размером во весь жесткий диск, обозначенный как раздел OpenBSD и отмеченный 
как загрузочный. Это будет наиболее приемлемый вариант для большинства установок OpenBSD, 
однако, есть системы, на которых этого не следует делать. Большинство компьютеров 
производства Compaq, некоторые Dell-системы и другие используют "восстановительные" 
разделы, которые должны оставаться нетронутыми. Если Ваша система имеет любые другие 
разделы любого типа, которые Вы не хотите стереть, не набирайте "yes" в ответ на вопрос.

<p>
Для такого примера, мы предположим, что диск разделен между OpenBSD и существующим Windows 
2000 разделом; выберем ответ по умолчанию ("no"), который вернет нас к программе fdisk(8). 
Информацию о fdisk(8) Вы можете получить <a href="faq14.html#fdisk">здесь</a>.

<p>
<b>Важное замечание:</b>
Обладателям больших жестких дисков (с объемом больше 8 Гб на новых i386-системах,
 так как на более старых машинах и других платформах, они чаще всего еще меньше), 
следует прочесть <a href="faq14.html#LargeDrive">этот раздел</a> перед тем, как 
двигаться дальше. 

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  You will now create a single MBR partition to contain your OpenBSD data. This
  partition must have an id of 'A6'; must *NOT* overlap other partitions; and
  must be marked as the only active partition.

  The 'manual' command describes all the fdisk commands in detail.

  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
  *0: 06    0   1  1 -  202 239 63 [          63:     3069297 ] DOS > 32MB
   1: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
  Enter 'help' for information
  fdisk: 1> <b>help</b>
          help            Command help list
          manual          Show entire OpenBSD man page for fdisk
          reinit          Re-initialize loaded MBR (to defaults)
          setpid          Set the identifier of a given table entry
          disk            Edit current drive stats
          edit            Edit given table entry
          flag            Flag given table entry as bootable
          update          Update machine code in loaded MBR
          select          Select extended partition table entry MBR
          print           Print loaded MBR partition table
          write           Write loaded MBR to disk
          exit            Exit edit of current MBR, without saving changes
          quit            Quit edit of current MBR, saving current changes
          abort           Abort program without saving current changes
  fdisk: 1> 
</pre></td></tr></table>

<p>
Некоторые команды требуют особого внимания:
<ul>
<li><b><tt>r</tt></b> или <b><tt>reinit</tt>:</b> очищает существующую 
таблицу разделов, создает один больший OpenBSD-раздел и отмечает его как 
активный. Аналогично ответу "yes" на вопрос "<tt>use *all* of ...</tt>".
<li><b><tt>p</tt></b> или <b><tt>print</tt>:</b>  показывает текущую таблицу 
в секторах. "<tt>p m</tt>" покажет таблицу разделов в мегабайтах, "<tt>p g</tt>"
- в гигабайтах.
<li><b><tt>e</tt></b> или <b><tt>edit</tt>:</b>  редактирование или изменение 
записи таблицы.
<li><b><tt>f</tt></b> или <b><tt>flag</tt>:</b>  отмечает раздел как загрузочный,
то есть тот, с которого будет производиться загрузка.
<li><b><tt>exit</tt></b> или <b><tt>quit</tt>:</b>  осторожнее с этими командами,
так как они имеют прямо противоположные значения.
</ul>

И снова грустное напоминание - ошибка в этом пункте приведет к потере данных! 
Если Вы делаете это на жестком диске с важными данными, то стоит сначала попрактиковаться 
на другом жестком диске и сделать backup.

<p>
На нашем диске расположен раздел размером 1.5Гбайт для Windows 2000, использующей файловую 
систему FAT. Глядя на информацию, представленную выше, мы видим, что раздел Windows заканчивается
на цилиндре 202. Поэтому мы отведем все оставшееся пространство под OpenBSD, начиная с цилиндра 
203. Вы можете определить начальный сектор OpenBSD - 306960 путем сложения начального сектора
существующего раздела (63) и ее размера (3069297).

<p>
Вы можете отредактировать разбиение диска в виде Cylinder/Heads/Sectors 
или напрямую в секторах. Как проще - это зависит от того, что Вы делаете; 
в данном случаем работать с существующим разделом проще в формате CHS.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk: 1> <b>e 1</b>
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
   1: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) <b>a6</b>
  Do you wish to edit in CHS mode? [n] <b>y</b>
  BIOS Starting cylinder [0 - 2585]: [0] <b>203</b>
  BIOS Starting head [0 - 239]: [0] <b><i>Enter</i></b>
  BIOS Starting sector [1 - 63]: [0] <b>1</b>
  BIOS Ending cylinder [0 - 2585]: [0] <b>2585</b>
  BIOS Ending head [0 - 239]: [0] <b>239</b>
  BIOS Ending sector [1 - 63]: [0] <b>63</b>
  fdisk:*1> <b>p</b>
  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
  *0: 06    0   1  1 -  202 239 63 [          63:     3069297 ] DOS > 32MB
   1: A6  203   0  1 - 2585 239 63 [     3069360:    36030960 ] OpenBSD
   2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
  fdisk:*1> <b>p m</b>
  Disk: wd0       geometry: 2586/240/63 [19092 Megabytes]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
  *0: 06    0   1  1 -  202 239 63 [          63:        1499M] DOS > 32MB
   1: A6  203   0  1 - 2585 239 63 [     3069360:       17593M] OpenBSD
   2: 00    0   0  0 -    0   0  0 [           0:           0M] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0M] unused
  fdisk:*1> 
</pre></td></tr></table>

<p>
Заметьте, приглашение изменилось - в нем появился значок "<tt>*</tt>", чтобы показать, 
что у Вас есть несохраненные изменения. Как мы видим, из вывода команды "<tt>p m</tt>",
мы не затронули раздел Windows, мы успешно выделили остаток диска под OpenBSD, 
и разделы не накладываются. Мы сделали это. Почти.

<p>
Что мы еще не сделали, так это не пометили раздел как активный, чтобы компьютер мог 
загрузить OpenBSD при следующей перезагрузке.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>f 1</b>
  Partition 1 marked active.
  fdisk:*1> <b>p</b>
  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
   0: 06    0   1  1 -  202 239 63 [          63:     3069297 ] DOS > 32MB
  *1: A6  203   0  1 - 2585 239 63 [     3069360:    36030960 ] OpenBSD
   2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
  fdisk:*1>
</pre></td></tr></table>

<p>
Теперь мы готовы сохранить изменения:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>w</b>
  Writing MBR at offset 0.
  wd0: no disk label
  fdisk: 1> <b>q</b>
</pre></td></tr></table> 

<p>

<a name="disklabel"></a>
<h3>Создание разделов диска</h3>
Следующим шагом будет использование 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">disklabel(8)</a> 
для разделения OpenBSD-раздела. Подробнее о использовании disklabel(8) Вы можете прочесть в 
<a href="faq14.html#disklabel">FAQ 14, disklabel</a>.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Here is the partition information you chose:
  
  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
  *0: 06    0   1  1 -  202 239 63 [          63:     3069297 ] DOS > 32MB
   1: A6  203   0  1 - 2585 239 63 [     3069360:    36030960 ] OpenBSD
   2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused

  You will now create an OpenBSD disklabel inside the OpenBSD MBR
  partition. The disklabel defines how OpenBSD splits up the MBR partition
  into OpenBSD partitions in which filesystems and swap space are created.

  The offsets used in the disklabel are ABSOLUTE, i.e. relative to the
  start of the disk, NOT the start of the OpenBSD MBR partition.

  disklabel: no disk label
  WARNING: Disk wd0 has no label. You will be creating a new one.
  
  # using MBR partition 1: type A6 off 3069360 (0x2ed5b0) size 36030960 (0x225c9f0)

  Treating sectors 3069360-39100320 as the OpenBSD portion of the disk.
  You can use the 'b' command to change this.

  Initial label editor (enter '?' for help at any prompt)
  > <b>?</b>
  Available commands:
          p [unit]  - print label.
          M         - show entire OpenBSD man page for disklabel.
          e         - edit drive parameters.
          a [part]  - add new partition.
          b         - set OpenBSD disk boundaries.
          c [part]  - change partition size.
          d [part]  - delete partition.
          D         - set label to default.
          g [d|b]   - Use [d]isk or [b]ios geometry.
          m [part]  - modify existing partition.
          n [part]  - set the mount point for a partition.
          r         - recalculate free space.
          u         - undo last change.
          s [path]  - save label to file.
          w         - write label to disk.
          q         - quit and save changes.
          x         - exit without saving changes.
          X         - toggle expert mode.
          z         - zero out partition table.
          ? [cmnd]  - this message or command specific help.
  Numeric parameters may use suffixes to indicate units:
          'b' for bytes, 'c' for cylinders, 'k' for kilobytes, 'm' for megabytes,
          'g' for gigabytes or no suffix for sectors (usually 512 bytes).
          Non-sector units will be rounded to the nearest cylinder.
  Entering '?' at most prompts will give you (simple) context sensitive help.
  > 
</pre></td></tr></table>

<p>
И снова несколько важных команд:
<ul>
<li><b><tt>p</tt></b> - печатает текущие разделы диска 
(далее для краткости - отметку) на экран, и Вы можете 
использовать модификаторы <tt>k, m</tt> или <tt>g</tt> 
для килобайт, мегабайт или гигабайт.
<li><b><tt>D</tt></b> - очищает все имеющиеся отметки 
и устанавливает новую отметку по умолчанию, которая затрагивает 
только текущий OpenBSD-раздел. Это может быть полезно в том случае, 
если диск уже имел отметку и размер раздела OpenBSD был изменен; 
старая отметка могла остаться и приносить неудобства.
<li><b><tt>m</tt></b> - изменяет существующую запись. Не переоценивайте то, 
что программа сделает для Вас. В то время как она умеет менять размеры разделов 
OpenBSD внутри ее собственного дискового участка, она не изменяет саму 
файловую систему на диске. Использование этой опции для изменения существующих 
разделов прямой путь к потере большого количества данных.
</ul>

<p>
Разбиение Вашего диска имеет большое значение. 
Ответ на вопрос "Как мне следует разбить диск?" звучит как "Именно так, как Вам необходимо".
Разбиение может меняться в зависимости от используемых служб. 
Универсального ответа не существует. Если Вы не уверены в том, как это делать правильно, 
<a href="#SpaceNeeded">прочтите следующее</a>.

<p>
На этой системе у нас есть 17 Гб, доступных для OpenBSD. 
Это большое количество, и нам вряд ли понадобится оно полностью. 
Поэтому мы специально не будем использовать минимальные размеры. 
Пусть лучше у нас останется несколько сот мегабайт неиспользуемого места, 
чем килобайт.

<p>
На корневом диске должны быть созданы 2 раздела - "a" и "b". 
Процедура инсталляции не может быть продолжена без этих разделов. 
Раздел "a" будет использовано для корневой файловой системы (/), 
а раздел "b" будет использоваться как место для подкачки.

<p>
После некоторых раздумий, мы решили создать раздельные разделы для 
создания рекомендуемых отдельных разделов (/, /tmp, /var, /usr, /home) вместе с 
разделом подкачки:
<ul>
<li><i><b>wd0a: /</b></i> (root) - 150M. Должно быть более чем достаточно.
<li><i><b>wd0b: </b></i>(swap) - 300M.
<li><i><b>wd0d: /tmp</b></i> - 120M.  <tt>/tmp</tt> 
используется при сборке некоторых программ, 120 Мб должно хватить в большинстве случаев.
<li><i><b>wd0e: /var</b></i> - 80M.  Если будет использоваться веб-сервер или почта, 
мы бы сделали этот раздел много больше, но это не то, что мы сейчас делаем.
<li><i><b>wd0g: /usr</b></i> - 2G.  
Мы хотим сделать этот раздел достаточно большим для запуска множества пользовательских 
приложений, плюс иметь возможность пересборки системы если это будет необходимо. Также 
здесь будет находиться <a href="../ports.html">дерево портов</a>, которое займет около 
100 Мб перед тем, как как порты будут собраны.
<li><i><b>wd0h: /home</b></i> - 4G. Достаточное количество места под файлы пользователей.
</ul>

Теперь, если Вы  сделали все это, у Вас осталось около 10 Гб неиспользуемого места! 
Пустое место ничего не заденет, и дает нам гибкость в изменении (увеличении) места в будущем, 
если потребуется. Требуется сделать больше раздел <i>/tmp</i>? Нет проблем, создайте новый 
на неиспользуемом пространстве, измените <i>/etc/fstab</i> и проблема решена.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>p m</b>
  device: /dev/rwd0c
  type: ESDI
  disk: ESDI/IDE disk
  label: ST320011A
  bytes/sector: 512
  sectors/track: 63
  tracks/cylinder: 16
  sectors/cylinder: 1008
  cylinders: 16383
  total sectors: 39102336
  free sectors: 36030960
  rpm: 3600
  
  16 partitions:
  #        size   offset    fstype   [fsize bsize   cpg]
    a: 17593.2M  1498.7M    unused        0     0
    c: 19092.9M     0.0M    unused        0     0
    i:  1498.7M     0.0M     MSDOS
  > <b>d a</b>
  > <b>a a</b>
  offset: [3069360] <b><i>Enter</i></b>
  size: [36030960] <b>150M</b>
  Rounding to nearest cylinder: 307440
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/</b>
  > <b>a b</b>
  offset: [3376800] <b><i>Enter</i></b>
  size: [35723520] <b>300M</b>
  Rounding to nearest cylinder: 614880
  FS type: [swap] <b><i>Enter</i></b>
  > <b>a d</b>
  offset: [3991680] <b><i>Enter</i></b>
  size: [35108640] <b>120m</b>
  Rounding to nearest cylinder: 245952
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/tmp</b>
  > <b>a e</b>
  offset: [4237632] <b><i>Enter</i></b>
  size: [34862688] <b>80m</b>
  Rounding to nearest cylinder: 164304
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/var</b>
  > <b>a g</b>
  offset: [4401936] <b><i>Enter</i></b>
  size: [34698384] <b>2g</b>
  Rounding to nearest cylinder: 4194288
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/usr</b>
  > <b>a h</b>
  offset: [8596224] <b><i>Enter</i></b>
  size: [30504096] <b>4g</b>
  Rounding to nearest cylinder: 8388576
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/home</b>
  > <b>p m</b>
  device: /dev/rwd0c
  type: ESDI
  disk: ESDI/IDE disk
  label: ST320011A
  bytes/sector: 512
  sectors/track: 63
  tracks/cylinder: 16
  sectors/cylinder: 1008
  cylinders: 16383
  total sectors: 39102336
  free sectors: 22115520
  rpm: 3600
  
  16 partitions:
  #        size   offset    fstype   [fsize bsize   cpg]
    a:   150.1M  1498.7M    4.2BSD     1024  8192    16  # /
    b:   300.2M  1648.8M      swap
    c: 19092.9M     0.0M    unused        0     0
    d:   120.1M  1949.1M    4.2BSD     1024  8192    16  # /tmp
    e:    80.2M  2069.2M    4.2BSD     1024  8192    16  # /var
    g:  2048.0M  2149.4M    4.2BSD     1024  8192    16  # /usr
    h:  4096.0M  4197.4M    4.2BSD     1024  8192    16  # /home
    i:  1498.7M     0.0M     MSDOS
  > <b>q</b>
  Write new label?: [y] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Вы заметите, что раздел <i>с</i> мы проигнорировали. Это раздел обозначает весь 
Ваш жесткий диск, даже не пытайтесь изменить его.  Вы также заметите, что раздел 
<i>i</i> был определен нами, это существующий раздел Windows 2000. Разделы не 
имеют строго назначенных букв, за исключением <i>a</i> (root), <i>b</i> (swap) и <i>c</i>
(весь диск), остальные буквы могут назначаться произвольно.

<p>
Если Вы внимательнее приглядитесь к выведенной информации, Вы заметите 
что значение RPM для Вашего жесткого диска скорее всего неверно. 
Исторически, скорость жесткого диска никак не влияет на систему, 
поэтому не беспокойтесь.

<h3>Конфигурирование точек монтирования и форматирование файловых систем</h3>

Наступает финальное назначение точек монтирования. Если Вы сконфигурировали точки 
монтирования с помощью 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">disklabel(8)</a>, 
то в этом шаге Вам следует просто подтвердить Ваш выбор, в противном случае, 
Вы можете назначить их сейчас.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  The root filesystem will be mounted on wd0a.
  wd0b will be used for swap space.
  Mount point for wd0d (size=122976k), none or done? [/tmp] <b><i>Enter</i></b>
  Mount point for wd0e (size=82152k), none or done? [/var] <b><i>Enter</i></b>
  Mount point for wd0g (size=2097144k), none or done? [/usr] <b><i>Enter</i></b>
  Mount point for wd0h (size=4194288k), none or done? [/home] <b><i>Enter</i></b>
  Mount point for wd0d (size=122976k), none or done? [/tmp] <b>done</b>
  Done - no available disks found.
 
  You have configured the following partitions and mount points:

  wd0a /
  wd0d /tmp
  wd0e /var
  wd0g /usr
  wd0h /home

  The next step creates a filesystem on each partition, ERASING existing data.
  Are you really sure that you're ready to proceed? [n] y
  /dev/rwd0a:     307440 sectors in 305 cylinders of 16 tracks, 63 sectors
          150.1MB in 20 cyl groups (16 c/g, 7.88MB/g, 1920 i/g)
  /dev/rwd0d:     245952 sectors in 244 cylinders of 16 tracks, 63 sectors
          120.1MB in 16 cyl groups (16 c/g, 7.88MB/g, 1920 i/g)
  /dev/rwd0e:     164304 sectors in 163 cylinders of 16 tracks, 63 sectors
          80.2MB in 11 cyl groups (16 c/g, 7.88MB/g, 1920 i/g)
  /dev/rwd0g:     4194288 sectors in 4161 cylinders of 16 tracks, 63 sectors
          2048.0MB in 261 cyl groups (16 c/g, 7.88MB/g, 1920 i/g)
  /dev/rwd0h:     8388576 sectors in 8322 cylinders of 16 tracks, 63 sectors
          4096.0MB in 521 cyl groups (16 c/g, 7.88MB/g, 1920 i/g)
  /dev/wd0a on /mnt type ffs (rw, asynchronous, local, ctime=Thu Oct 10 21:
  50:36 2 002)
  /dev/wd0h on /mnt/home type ffs (rw, asynchronous, local, nodev, nosuid,
   ctime=Thu Oct 10 21:50:36 2002)
  /dev/wd0d on /mnt/tmp type ffs (rw, asynchronous, local, nodev, nosuid, 
  ctime=Thu Oct 10 21:50:36 2002)
  /dev/wd0g on /mnt/usr type ffs (rw, asynchronous, local, nodev, ctime=Th
  u Oct 10 21:50:36 2002)
  /dev/wd0e on /mnt/var type ffs (rw, asynchronous, local, nodev, nosuid, 
  ctime=Th u Oct 10 21:50:36 2002)
</pre></td></tr></table>

<p>
Вы можете удивиться тому, чтобы программа инсталляции снова запросила 
информацию о точках монтирования. Это позволит Вам исправить ошибки или опечатки 
в определении точек монтирования в процессе их создания. Как исключение, программа 
инсталляции автоматически удалит дублированные точки монтирования, которые Вы введете 
в процессе конфигурирования программой disklabel. Сама программа disklabel позволит 
Вам ввести подобные повторения, поэтому они должны быть перепроверены после ее завершения. 
Удаленные точки монтирования приведут к наличию разделов без привязки, поэтому Вам следует 
назначить новые точки монтирования если Вы желаете использовать пространство.

<p>
Заметьте что на вопрос "Вы уверены, что хотите продолжать?" ответ по умолчанию "no" (нет), 
поэтому Вам следует однозначно сказать программе, что Вы желаете продолжить и форматировать Ваши 
разделы. Если Вы выберете "no", Вы будете просто выброшены в shell и сможете начать 
процесс начала, набрав install, или просто перезагрузиться заново, используя загрузочный диск.

<p>
В этой точке все файловые системы будут отформатированы. Это отнимет некоторое время, 
зависящее от размера разделов и скорости диска.

<a name="Hostname"></a>
<h3>4.3.2 - Установки имени хоста</h3>
<p>
Теперь Вы должны установить системное имя (название хоста).  Это значение будет сохранено в файле 
<tt>/etc/myname</tt>, который используется в процессе загрузки для установки имени системы. 
В OpenBSD 3.2 имя, хранимое в файле <tt>/etc/myname</tt> включает Полностью Определенное Доменное Имя
системы (fully qualified domain name of the system - FQDN). Если Вы не определите FQDN для системы,
будет использовано значение по умолчанию "my.domain".

<p>
Важно установить имя сейчас, потому что оно будет использовано при генерации
криптографических ключей для системы в процессе первой загрузки системы. Эта операция
будет произведена вне зависимости от того, были ли сконфигурированы сетевые параметры 
или нет.

<p> 
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Enter system hostname (short form, e.g. 'foo'): <b>puffy</b>
</pre></td></tr></table>

<a name="Network"></a>
<h3>4.3.3 - Настройка сети</h3>

<p>
Теперь необходимо произвести сетевые настройки. Если Вы хотите
установить систему с помощью FTP или NFS вы должны ввести правильно настройки,
так как на их базе будет проходить инсталляция. Давайте пройдемся по процессу 
настройки сети.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Configure the network? [y] <b><i>Enter</i></b>
  Available interfaces are: fxp0.
  Which one do you wish to initialize? (or 'done') [fxp0] <b><i>Enter</i></b>
  Symbolic (host) name for fxp0? [puffy] <b><i>Enter</i></b>
  The default media for fxp0 is
          media: Ethernet autoselect (100baseTX full-duplex)
  Do you want to change the default media? [n] <b><i>Enter</i></b>
  IP address for fxp0? (or 'dhcp') <b>199.185.137.55</b>
  Netmask? [255.255.255.0] <b><i>Enter</i></b>
  Done - no available interfaces found.
  DNS domain name? (e.g. 'bar.com') [my.domain] <b>example.com</b>
  DNS nameserver? (IP address or 'none') [none] <b>199.185.137.1</b>
  Use the nameserver now? [y] <b><i>Enter</i></b>
  Default route? (IP address, 'dhcp' or 'none') <b>199.185.137.128</b>
  add net default: gateway 199.185.137.128
  Edit hosts with ed? [n] <b><i>Enter</i></b> 
  Do you want to do any manual network configuration? [n] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
В приведенном примере мы использовали статический IP-адрес.

As indicated, you can
use "<tt>dhcp</tt>" instead on most platforms (not
<a href="../alpha.html">Alpha</a>), assuming your environment supports
it. 

В случае выбора DHCP большая часть информации будет получена с удаленного
сервера DHCP, которую Вы сможете подтвердить позднее. Ниже представлен пример
настройки сети с помощью DHCP:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Configure the network? [y] <b><i>Enter</i></b>
  Available interfaces are: fxp0.
  Which one do you wish to initialize? (or 'done') [fxp0] <b><i>Enter</i></b>
  Symbolic (host) name for fxp0? [puffy] <b><i>Enter</i></b>
  The default media for fxp0 is
          media: Ethernet autoselect (100baseTX full-duplex)
  Do you want to change the default media? [n] <b><i>Enter</i></b>
  IP address for fxp0? (or 'dhcp') <b>dhcp</b>
  Issuing hostname-associated DHCP request for fxp0.
  Internet Software Consortium DHCP Client 2.0pl5-OpenBSD
  Listening on BPF/fxp0/00:08:c7:77:b4:6b
  Sending on   BPF/fxp0/00:08:c7:77:b4:6b
  Sending on   Socket/fallback/fallback-net
  DHCPDISCOVER on fxp0 to 255.255.255.255 port 67 interval 1
  DHCPOFFER from 199.185.137.128
  DHCPREQUEST on fxp0 to 255.255.255.255 port 67
  DHCPACK from 199.185.137.128 
  New Network Number: 199.185.137.0
  New Broadcast Address: 199.185.137.255
  bound to 199.185.137.55 -- renewal in 43200 seconds.
  Done - no available interfaces found.
  DNS domain name? (e.g. 'bar.com') [example.org] <b><i>Enter</i></b>
  DNS nameserver? (IP address or 'none') [199.185.137.1] <b><i>Enter</i></b>
  Use the nameserver now? [y] <b><i>Enter</i></b>
  Default route? (IP address, 'dhcp' or 'none') [199.185.137.128] <b><i>Enter</i></b>
  add net default: gateway 199.185.137.128
  Edit hosts with ed? [n] <b><i>Enter</i></b>
  Do you want to do any manual network configuration? [n] <b><i>Enter</i></b>
</pre></td></tr></table>
<p>

<b>ПОМНИТЕ: </b>Только <b>один</b> интерфейс может быть просто сконфигурирован
с использованием DHCP в процессе инсталляции. Если Вы попытаетесь сконфигурировать
более одного интерфейса с помощью DHCP это приведет к ошибкам. Дополнительные интерфейсы 
Вам придется настраивать вручную.

<p>
Теперь мы установим пароль суперпользователя:
<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
Password for root account? (will not echo) <b><i>pAssWOrd</i></b>
Password for root account? (again) <b><i>pAssWOrd</i></b>
</pre></td></tr></table>
<p>
Используйте безопасный пароль для суперпользователя. Остальных пользователей
Вы можете создать после перезагрузки. Ниже приведена выдержка из
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=1">passwd(1)</a> (вольный перевод):
<pre>
    Новый пароль должен состоять как минимум из шести символов, необязательно
    в алфавитном порядке. Общая длинна пароля не должна превышать значение
    переменной _PASSWORD_LEN (в настоящее время 128 символов). Лучше если он 
    будет содержать строчные и прописные буквы, числа и знаки препинания.
</pre>

<a name="InstMedia"></a>
<h3>4.3.4 - Выбор носителя для инсталляции</h3>

<p>
После настройки сети, процедура установки даст Вам шанс внести поправки
в настройки вручную. Затем созданные Вами файловые разделы будут смонтированы
и установлен пароль суперползивателя. После этого Ваши диски будут готовы к
установки системы.

<p>
Следующим этапом будет выбор инсталляционного носителя. Варианты выбора
представлены ниже.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  You will now specify the location and names of the install sets you want to
  load. You will be able to repeat this step until all of your sets have been
  successfully loaded. If you are not sure what sets to install, refer to the
  installation notes for details on the contents of each.
 
  Sets can be located on a (m)ounted filesystem; a (c)drom, (d)isk or (t)ape
  device; or a (f)tp, (n)fs or (h)ttp server.
  Where are the install sets? <b>c</b>
  Available CD-ROMs are: cd0.
</pre></td></tr></table>

<p>
В этом примере мы выбрали установку с CD-ROM. Затем система выведет
список устройств которые были сконфигурированы как CD-ROM. У большинства людей
стоит одно такое устройство, однако, если их у Вас несколько, убедитесть, что
Вы выбрали нужное.

<p>
<b>ПОМНИТЕ: </b>Из всех представленных возможных источников инсталляционных пакетов
не все могут быть доступны на Вашем компьютере, например, в списке представлен (n)fs,
однако, не все архитектуры позволяют производить инсталяцию с использованием NFS.
Если Вы выберите недоступный источник, Вы получите сообщение об ошибке и шанс
выбрать другой тип источника инсталляционных пакетов.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available CD-ROMs are: cd0.
  Which one contains the install media? (or 'done') [cd0] <b><i>Enter</i></b>

  Pathname to the sets?  (or 'done') [3.3/i386] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Здесь Вам предлагается выбрать каталог в котором находятся инсталляционные файлы,
который на официальном CD-ROM называется <tt>3.3/i386/</tt>.  

<a name="Filesets"></a>
<h3>4.3.5 - Выбор пакетов для установки .</h3>

<p>
Теперь пришло время выбрать какие пакеты Вы хотите установить. Вы можете
ознакомиться с описанием каждого пакеты 
<a href="#FilesNeeded">в следующем разделе</a>. Файлы, найденные
программой инсталляции, будут представлены на экране. Вам всего лишь нужно
выбрать какие из них Вы хотите установить. По-умолчанию, выбраны 
все пакеты, за исключением содержащих оконную среду X; однако некоторые 
пользователи могуть пожелать выбрать минимальный набор для работы OpenBSD,
в котором будут <tt>base33.tgz</tt>, <tt>etc33.tgz</tt> и <tt>bsd</tt>. 
Другие могут захотеть установить все пакеты. В приведенном примере, показано
как произвести полную установку.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  The following sets are available. Enter a filename, 'all' to select
  all the sets, or 'done'. You may de-select a set by prepending a '-'
  to its name.

          [X] bsd
          [ ] bsd.rd
          [X] base33.tgz
          [X] etc33.tgz
          [X] misc33.tgz
          [X] comp33.tgz
          [X] man33.tgz
          [X] game33.tgz
          [ ] xbase33.tgz
          [ ] xshare33.tgz
          [ ] xfont33.tgz
          [ ] xserv33.tgz

  File Name? (or 'done') [bsd.rd] <b>all</b>

  The following sets are available. Enter a filename, 'all' to select
  all the sets, or 'done'. You may de-select a set by prepending a '-'
  to its name.

          [X] bsd
          [X] bsd.rd
          [X] base33.tgz
          [X] etc33.tgz
          [X] misc33.tgz
          [X] comp33.tgz
          [X] man33.tgz
          [X] game33.tgz
          [X] xbase33.tgz
          [X] xshare33.tgz
          [X] xfont33.tgz
          [X] xserv33.tgz
</pre></td></tr></table>

<p>
Вы можеть сделать здесь некотороые прикольные вещи, например
<tt>-x*</tt> удалит все компоненты X, если Вы вдруг передумали.
В нашем случае мы собираемся установить весь набор. Если Вы планируете
установить меньшее количество пакетов, начините с базового набора.
Более подробную информацию по выбору пакетов Вы найдете
<a href="#FilesNeeded">здесь</a>.

<p>
После того, как Вы выберите пакеты для установки, Вас попросят подтвердить 
выбор и только после этого они будут установлены. Индикатор состояния будет 
держать Вас в курсе относительно времени, которое займет установка.
Время установки сильно варьируется в зависимости от того, на каком
компьютере идет установка, устанавливаемых пакетов и скорости передачи пакетов
с инсталляционного носителя. Эта часть инсталляции может занимать от нескольких
минут до нескольких часов. 

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  File Name? (or 'done') [done] <b><i>Enter</i></b>
  Ready to install sets? [y] <b><i>Enter</i></b>
  Getting bsd ...
  100% |**************************************************|  4472 KB    00:03
  Getting bsd.rd ...
  100% |**************************************************|  4190 KB    00:02
  Getting base33.tgz ...
  100% |**************************************************| 30255 KB    00:21
  Getting etc33.tgz ...
  100% |**************************************************|  1469 KB    00:01
  Getting misc33.tgz ...
  100% |**************************************************|  1828 KB    00:01
  Getting comp33.tgz ...
  100% |**************************************************| 16207 KB    00:13
  Getting man33.tgz ...
  100% |**************************************************|  5921 KB    00:04
  Getting game33.tgz ...
  100% |**************************************************|  2545 KB    00:01
  Getting xbase33.tgz ...
  100% |**************************************************|  9073 KB    00:06
  Getting xshare33.tgz ...
  100% |**************************************************|  1574 KB    00:02
  Getting xfont33.tgz ...
  100% |**************************************************| 30666 KB    00:21
  Getting xserv33.tgz ...
  100% |**************************************************| 14948 KB    00:11

  Sets can be located on a (m)ounted filesystem; a (c)drom, (d)isk or (t)ape
  device; or a (f)tp, (n)fs or (h)ttp server.
  Where are the install sets? (or 'done')
</pre></td></tr></table>

<p>
Здесь Вы можете указать дополнительные пакеты для установки, расположенных
на других носителях или '<tt>done</tt>' если Вы установили все что хотели.

<p>
Если Ваша система имеет мало памяти в ОЗУ (меньше чем 20М на платворме i386),
не отвечайте здесь простым нажатием <b><i>Enter</i></b>!

<a name="SmallRAM"></a>
<h3>4.3.6 - Дополнительные шаги на машинах с малым объемом оперативной памяти</h3>
Так как сама система увеличилась в объеме, минимальное количество необходимой для работы
памяти так же увеличилось и продолжает увеличиваться. Следующий шаг инсталляции требует более 16 Мб памяти, и
может окончится неудачей на старых компьютерах с менее чем 20 Мб ( как правило это на платформе i386,
другие платформы требуютменьше памяти, хотя данный трюк может быть использаван на них с тем же успехом,
если они будут работать на машинах с минимальными требованиями).

<p>
Во время нормального процесса установки системы подкачка (swap) не задействована, система обходится
доступной памятью. На следующем шаге  'MAKEDEV' требуется гораздо больше памяти, 
чем для всей остальной процедуры установки. Также система с малым количеством памяти может
успешно выполнять различные приложения, используя этот трюк.

<p>
Решение этой проблемы заключается в активизации подкачки. Раздел подкачки уже создан,
необходимые программы установлены, осталось только активизировать подкачку вручную.
Поэтому, вместо того, чтобы просто набрать '<tt>done</tt>' в представленном выше приглашении,
введите '!', что запустит оболочку, и запустите 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=swapon&amp;sektion=8">swapon(8)</a>
со смонтированного диска:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Where are the install sets? (or 'done') <b>!</b>
  Type 'exit' to return to install.
  # <b>/mnt/sbin/swapon /dev/wd0b</b>
  # <b>exit</b>
  Where are the install sets? (or 'done') <b>done</b>
</pre></td></tr></table>

<p>
Теперь Вы можете продолжить нормальную установку.

<a name="Finish"></a>
<h3>4.3.7 - Завершение инсталляции</h3>

Таперь Вам нужно ответить на вопрос о запуске X на Вашейм компьютере.
Если Вы ответите 'Y', в файл <tt>/etc/sysctl.conf</tt> будет добавлена
строка <tt>machdep.allowaperture=1</tt> или <tt>machdep.allowaperture=2</tt>
в зависимости от платформы.

<p>
Последнне что нужно будет сделать это установить временную зону.
В зависимости от того где расположен Ваш компьютер, ответ на это вопрос может 
иметь несколько однозначных вариантов, например, <tt>US/Eastern</tt> может быть
с успехом быть заменен <tt>EST5EDT</tt> или <tt>US/Michigan</tt>, так как эти варианты
представляют одну и ту же зону. Чтобы получить список возможных вариантов, введите '?'.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Extract more sets? [n] <b><i>Enter</i></b>
  Do you expect to run the X Window System? [y] <b>y</b>
  Saving configuration files......done.
  Generating initial host.random file ......done.
  What timezone are you in? ('?' for list) [US/Pacific] <b>?</b>
  Africa/      Chile/       GB-Eire      Israel       NZ-CHAT      Turkey
  America/     Cuba         GMT          Jamaica      Navajo       UCT
  Antarctica/  EET          GMT+0        Japan        PRC          US/
  Arctic/      EST          GMT-0        Kwajalein    PST8PDT      UTC
  Asia/        EST5EDT      GMT0         Libya        Pacific/     Universal
  Atlantic/    Egypt        Greenwich    MET          Poland       W-SU
  Australia/   Eire         HST          MST          Portugal     WET
  Brazil/      Etc/         Hongkong     MST7MDT      ROC          Zulu
  CET          Europe/      Iceland      Mexico/      ROK          posix/
  CST6CDT      Factory      Indian/      Mideast/     Singapore    posixrules
  Canada/      GB           Iran         NZ           SystemV/     right/
  What timezone are you in? ('?' for list) [US/Pacific] <b>US</b>
  What sub-timezone of 'US' are you in? ('?' for list) <b>?</b>
  Alaska          Central         Hawaii          Mountain        Samoa
  Aleutian        East-Indiana    Indiana-Starke  Pacific
  Arizona         Eastern         Michigan        Pacific-New
  Select a sub-timezone of 'US' ('?' for list): <b>Eastern</b>
  Setting local timezone to 'US/Eastern'...done.
</pre></td></tr></table>

<p>
Если Вы заинтересованы в точном времени, прочтите 
<a href="faq8.html#NTPerror">это</a>.

<p>
Последнее что будет сделано - создан каталог <tt>/dev</tt>
(что может занять много времени, особенно на системах, использующих 
трюк с
<a href="#SmallRAM">малым количеством памяти</a>), и инсталляция загрузочных 
блоков. 

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Making all device nodes...done.
  Installing boot block...
  boot: /mnt/boot
  proto: /usr/mdec/biosboot
  device: /dev/rwd0c
  /usr/mdec/biosboot: entry point 0
  proto bootblock size 512
  room for 12 filesystem blocks at 0x16f
  Will load 7 blocks of size 8192 each.
  Using disk geometry of 63 sectors and 240 heads.
   0:  9 @(203 150 55) (3078864-3078872)
   1: 63 @(203 151 1) (3078873-3078935)
   2: 24 @(203 152 1) (3078936-3078959)
   3: 16 @(203 8 47) (3069910-3069925)
  /mnt/boot: 4 entries total
  using MBR partition 1: type 166 (0xa6) offset 3069360 (0x2ed5b0)
  ...done.

  CONGRATULATIONS! Your OpenBSD install has been successfully completed!
  To boot the new system, enter halt at the command prompt. Once the
  system has halted, reset the machine and boot from the disk.
  # <b>halt</b>
  syncing disks... done

  The operating system has halted.
  Please press any key to reboot.
</pre></td></tr></table>

<p>
Теперь OpenBSD установлена на Вашем компьютере и готова к своей первой загрузке,
но перед этим...

<p>

<h4>Перед тем как перезагрузиться</h4>
Теперь система инсталлирована и готова к перезагрузке и последующей настройке.
Однако перед этим не лишним будет проверить <a href="../errata.html">последние изменения</a>
,чтобы убедится в том, что в системе не было обнаружено серьезных ошибок, способных
вывести систему из строя.

<h4>После перезагрузки</h4>

<p>
Первое что Вам необходимо сделать это внимательно прочитать
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8">afterboot(8)</a>.

<p>
Следующие ресурсы так же могут оказать очень полезными:
<ul>
<li><a href="faq10.html#AddDelUser">Добавление пользователей в OpenBSD</a> 
<li><a href="faq6.html#Setup">Начальная настройка сети</a>
<li><a href="faq2.html#ManPages">Страницы руководства на наиболее полезные/популярные программы</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi">Страницы руководства по OpenBSD on-line</a>
<li><a href="../ports.html">Система портов и пакетов OpenBSD</a>, см. также  
<a href="faq8.html#Ports">здесь</a> и <a href="faq8.html#Packages">здесь</a>
</ul>

<h4>И последнее...</h4>
Разработчики OpenBSD просят Вас
<a href="#SendDmesg">послать копию dmesg</a>. 

 This is 
really appreciated by the developers, and ultimately, all 
users.

<a name="OtherInf"></a>
<h3>4.3.8 - Другие информационные ресурсы</h3>

Существует набор документов которые могут быть полезны тем, кто
испытывает проблемы или интересуется подробностями инсталляции. 
Ва можете скачать эти документы с 
<a href="../ftp.html">FTP или зеркал</a>.
<ul>
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.i386">INSTALL.i386</a> 
  - Исчерпывающее руководство по установке. Аналогичные документы существуют для всех платформ.
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.linux">INSTALL.linux</a> 
  - Установка OpenBSD с Linux.
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.mbr">INSTALL.mbr</a> 
  - Описание Главной Загрузочной Записи (Master Boot Record).
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.pt">INSTALL.pt</a> 
  - Описание Таблиц Разделов (Partition Tables).
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.dbr">INSTALL.dbr</a> 
  - Загрузочный сектор дискеты с DOS.
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.chs">INSTALL.chs</a> 
  - Объяснение работы CHS.
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.ata">INSTALL.ata</a> 
  - ATA/ATA-1/ATA-2/IDE/EIDE/др. ЧаВО 
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.os2br">INSTALL.os2br</a>
 - Загрузочный сектор os2.
</ul>

<p>
<a name= "FilesNeeded"></a>
<h2>4.4 - Какие файлы нужны для инсталляции?</h2>
<!-- XXXrelease -->

<p>
Дистрибутив OpenBSD разбит на несколько отдельных <i>наборов файлов</i>.
Не каждое приложение требует наличие этих наборов. Ниже представлено их описание:
<p>
<ul>
  <li><b><i>bsd</i></b>          - Ядро системы. <b>Обязательно</b>
  <li><b><i>bsd.rd</i></b> - <a href="#bsd.rd">RAM disk kernel</a>
  <li><b><i>base33.tgz</i></b>   - Содержит основные файлы системы <b>Обязательно</b>
  <li><b><i>etc33.tgz</i></b>    - Содержит все файлы каталога /etc <b>Обязательно</b>
  <li><b><i>comp33.tgz</i></b>    - Содержит компилятор и необходимые утилиты, библиотеки. <b>Желательно</b>
  <li><b><i>man33.tgz</i></b>    - Содержит страницы руководства <b>Желательно</b>
  <li><b><i>misc33.tgz</i></b>   - Содержит различную информацию, документацию по настройки
  <li><b><i>game33.tgz</i></b>   - Содержит игрушки для OpenBSD
  <li><b><i>xbase33.tgz</i></b>  - Создержит основные файлы для X11
  <li><b><i>xfont33.tgz</i></b>  - Содержит шрифты и сервер для шрифтов
  <li><b><i>xserv33.tgz</i></b>  - Содержит дополнительные сервера для X11
  <li><b><i>xshare33.tgz</i></b> - Содержит страницы руководства, установки для локализации, includesи т.п. для  X
</ul>

<p>
<a name= "SpaceNeeded"></a>
<h2> 4.5 - How much space do I need for an OpenBSD installation?</h2>
<!-- XXXrelease -->

<p>
The following are minimum suggested filesystem sizes for a full system
install.  The numbers include enough extra space to permit you to run a
typical home system that is connected to the Internet.

<ul>
<li>These are minimum values.  
<li>If you plan to install a significant amount of third party software,
make your <tt>/usr</tt> partition large!  <b>At least</b> triple these
values!
<li>For a system that handles lots of email or web pages (stored,
respectively, in <tt>/var/mail</tt> and <tt>/var/www</tt>) you will want
to make your <tt>/var</tt> partition significantly larger, or put them
on separate partitions.
<li>For a multiuser system which may generate lots of logs, you will
still want to make your <tt>/var</tt> partition significantly larger
(<tt>/var/log</tt>).
<li>If you plan to rebuild the kernel or system from source, you will
want to make the <tt>/usr</tt> partition significantly larger, <b>at
least</b> 800M-1G larger than indicated below.
</ul>

As you read this, keep in mind that <tt>/usr</tt> and
<tt>/usr/X11R6</tt> are usually both parts of the same filesystem, that
is, <tt>/usr</tt>, as there is no big advantage to making them into
separate filesystems.

<blockquote>
<pre>
<b>
SYSTEM          /       /usr    /var    /usr/X11R6
alpha           80M     250M    25M     140M
hp300           80M     250M    25M     140M
hppa           100M     200M    25M     120M
i386            60M     250M    25M     140M
mac68k          80M     250M    25M     100M
macppc          80M     250M    25M     140M
mvme68k         80M     250M    25M     100M
sparc           80M     250M    25M     120M
sparc64         80M     250M    25M     100M
vax            100M     200M    25M     120M
</b>
</pre>
</blockquote>

In addition, it is recommended that a <tt>/tmp</tt> partition be used.
The <tt>/tmp</tt> partition is used in the compiling of ports, among
other things, so how big you make it depends on what you do with it.
50M may be plenty for most people, but some large applications may
require 100M or more of <tt>/tmp</tt> space.

<p>
When you are in the disklabel editor, you may choose to make your entire
system have just an 'a' (main filesystem) and 'b' (swap) .  The 'a'
filesystem which you set up in disklabel will become your root
partition, which should be the sum of all the 3 main values above
(<tt>/</tt>, <tt>/usr</tt>, and <tt>/var</tt>) plus some space for
<tt>/tmp</tt>.  The 'b' partition you set up automatically becomes your
system swap partition -- we recommend a minimum of 32MB but if you have
disk to spare make it at least 64MB.  If you have lots of disk space to
spare, make this 256MB, or even 512MB.

<p>
Swap space is used to store system core dumps on in the event of a
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crash&amp;sektion=8">crash(8)</a>.
If this is a consideration for you, your swap space should be slightly
larger than the amount of main memory you are likely to ever have in the
system.  Note that upon reboot, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=savecore&amp;sektion=8">savecore(8)</a>
will attempt to save the contents of the swap partition to a file in
<tt>/var/crash</tt> so again, if this is a priority for you, your
<tt>/var</tt> partition must have enough <i>free space</i> to hold these
dump files.

<p>
There are five main reasons for using separate filesystems, instead of
shoving everything into one or two filesystems:

<ul>
<li><b>Security</b>: You can mark some filesystems as 'nosuid', 'nodev', 
  'noexec', 'readonly', etc.  This is now done by the install process,
  in fact, if you use the above described partitions.
<li><b>Stability</b>: A user, or a misbehaved program, can fill a 
  filesystem with garbage if they have write permissions for it.  Your 
  critical programs, which of course run on a different filesystem, do 
  not get interrupted.
<li><b>Speed</b>: A filesystem which gets written to frequently may get
  somewhat fragmented.  (Luckily, the ffs filesystem, what OpenBSD uses,
  is not prone to heavy fragmentation.)
<li><b>Integrity</b>: If one filesystem is corrupted for some reason
  then your other filesystems are still OK.
<li><b>Size</b>: Many platforms have limits on the area of a disk where
  the boot ROM can load the kernel from.  In some cases, this limit may
  be very small (504M for an older 486), in other cases, a much larger
  limit (8G on new i386 systems).  As the kernel can end up anywhere in
  the root partition, the entire root partition should be within this
  area. For more details, see <a href="faq14.html#LargeDrive">this
  section</a>.  A good guideline might be to keep your / partition
  completely below 2G, unless you know your platform (and particular
  machine!) can handle more (or less!) than that.
</ul>

<p>
Some additional thoughts on partitioning:
<ul>
 <li>For your first attempt at an experimentation system, one big
   <tt>/</tt> partition and swap may be easiest until you know how much
   space you need. By doing this you will be sacrificing some of the
   default security features of OpenBSD that require separate
   filesystems for <tt>/, /tmp, /var, /usr</tt> and <tt>/home</tt>.
 <li>A system exposed to the Internet or other hostile forces should
   have a separate <tt>/var</tt> (and maybe even a separate
   <tt>/var/log</tt>) for logging.
 <li>A <tt>/home</tt> partition can be nice.  New version of the OS?
   Wipe and reload everything else, leave your <tt>/home</tt> partition
   untouched.  Remember to save a copy of your configuration files,
   though!
 <li>A separate partition for anything which may accumulate a large
   quantity of files that may need to be deleted can be faster to
   reformat and recreate than to delete.  See the <a
   href="upgrade-minifaq.html#1.5">upgrade-minifaq</a> for an example
   (<tt>/usr/obj</tt>).
 <li>If you wish to rebuild your system from source for any reason,
   the source will be in <tt>/usr/src</tt>.  If you don't make a
   separate partition for <tt>/usr/src</tt>, make sure <tt>/usr</tt> has
   sufficient space.
 <li>A commonly forgotten fact: you do <b>not</b> have to allocate
   all space on a drive when you set the system up! Since  you will now
   find it a challenge to buy a new drive smaller than 20G, it can make
   sense to leave a chunk of your drive unallocated.  If you outgrow a
   partition, you can allocate a new partition from your unused space,
   <a href="faq10.html#DupFS">duplicate</a> your existing partition to
   the new partition, change
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5">/etc/fstab</a>
   to point to the new partition, remount, you now have more space.
 <li>If you make your partitions too close to the minimum size required,
   you will probably regret it later, when it is time to upgrade your
   system.
 <li>If you permit users to write to <tt>/var/www</tt> (i.e., personal
   web pages), you might wish to put it on a separate partition, so you
   can use <a href="faq10.html#Quotas">quotas</a> to restrict the space
   they use, and if they fill the partition, no other parts of your
   system will be impacted.
</ul>


<p>
<a name= "Multibooting"></a>
<h2>4.6 - Multibooting OpenBSD (i386)</h2>

Multibooting is having several operating systems on one computer, and
some means of selecting the which OS is to boot.  It is <i>not</i> a
trivial task!  If you don't understand what you are doing, you may
end up deleting large amounts of data from your computer.  New OpenBSD
users are <i>highly</i> encouraged to start with a blank hard drive on a
dedicated machine, and then practice your desired configuration on a
non-production system before attempting a multiboot configuration on a
production machine.  <a href="faq14.html">FAQ 14</a> has more
information about the OpenBSD boot process.

<p>
When multibooting, the requirements of all operating systems must be met
by your configuration.  People often ask if there is a way around the
<a href="faq14.html#LargeDrive">8G boot limit</a> of OpenBSD.  While
there are some programs that claim to get around various limits of
various operating systems, none of them are known to do this with
current versions of OpenBSD.

<p>
Here are several options to multibooting:

<h3>Setting active partitions</h3>
This is probably the most overlooked, and yet, sometimes the best
solution for multibooting.  Simply set the active partition in whatever
OS you are currently using to be the one you want to boot by default
when you next boot.  Virtually every OS offers a program to do
this; OpenBSD's is <a href="faq14.html#fdisk">fdisk(8)</a>, similar
named programs are in Windows 9x and DOS, and many other operating
systems.  This can be highly desirable for OSs or systems which take a
long time to shut down and reboot -- you can set it and start the reboot
process, then walk away, grab a cup of coffee, and come back to the system
booted the way you want it -- no waiting for the Magic Moment to select
the next OS.

<h3>Boot floppy</h3>
If you have a system that is used to boot OpenBSD infrequently (or don't
wish other users of the computer to note anything has changed), consider
using a boot floppy.  Simply use one of the <a href="#MkFlop">standard
OpenBSD install floppies</a>, and create a <tt>/etc/boot.conf</tt> file
(yes, you will also have to create an <tt>/etc</tt> directory on the
floppy) with the contents:

<pre>
     boot hd0a:/bsd
</pre>

to cause the system to boot from hard drive 0, OpenBSD partition 'a',
kernel file <tt>/bsd</tt>.  Note you can also boot from other drives
with a line like: "<tt>boot hd2a:/bsd</tt>" to boot off the third
hard drive on your system.  To boot from OpenBSD, slip your floppy in,
reboot.  To boot from the other OS, eject the floppy, reboot.  

<p>
In this case, the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>
program is loaded from the floppy, looks for and reads
<tt>/etc/boot.conf</tt>.  The "<tt>boot hd0a:/bsd</tt>" line instructs
boot(8) where to load the kernel from -- in this case, the first HD the
BIOS sees.  Keep in mind, only a small file (<tt>/boot</tt>) is loaded
from the floppy -- the system loads the entire kernel off the hard disk,
so this only adds about five seconds to the boot process.

<h3>Windows NT/2000/XP NTLDR</h3>

To multiboot OpenBSD and Windows NT/2000/XP, you can use NTLDR, the
boot loader that NT uses. To multi-boot with NT,  you need a copy of your
OpenBSD Partition Boot Record (PBR). After running installboot, you can
copy it to a file using 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>:

<pre>
	# <strong>dd if=/dev/rsd0a of=openbsd.pbr bs=512 count=1</strong>
</pre>

<p>
Now boot NT and put <tt>openbsd.pbr</tt> in C:. Add a line like this to
the end of <tt>C:\BOOT.INI</tt>:

<pre>
	c:\openbsd.pbr="OpenBSD"
</pre>

<p>
When you reboot, you should be able to select OpenBSD from the NT loader
menu. There is much more information available about NTLDR at the 
<a href="http://www.tburke.net/info/ntldr/ntldr_hacking_guide.htm">NTLDR
Hacking Guide.</a>

<p>
On Windows XP you can also edit the boot information using the GUI; see the
<a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q289022">XP 
Boot.ini HOWTO</a>.

<p>
Note: The Windows NT boot loader is only capable of booting OSs from the
primary hard drive.  You can not use it to load OpenBSD from the second drive
on a system.

<p>
<h3>Other boot loaders</h3>

<p>
Some other bootloaders OpenBSD users have used successfully include 
<a href="http://gag.sourceforge.net/">GAG</a>,
<a href="http://www.freebird.org/sw-map/bootmanager.html">OSBS</a>,
<a href="http://www.ranish.com/part/">The Ranish Partition Manager</a>
and <a href="http://www.gnu.org/software/grub/">GRUB</a>. 

<p>
<h3>OpenBSD and Linux (i386)</h3>
<!-- XXXversion -->

<p>
Please refer to 
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.3/i386/INSTALL.linux">INSTALL.linux</a>,
which gives in depth instructions on getting OpenBSD working with Linux.

<a name= "SendDmesg"></a>
<h2>4.7 - Sending your dmesg to dmesg@openbsd.org after the install</h2>

<p>
Just to remind people, it's important for the OpenBSD developers to keep
track of what hardware works, and what hardware doesn't work perfectly.

<p>
A quote from /usr/src/etc/root/root.mail
<pre>
If you wish to ensure that OpenBSD runs better on your machines, please do us
a favor (after you have your mail system configured!) and type
        dmesg | mail dmesg@openbsd.org
so that we can see what kinds of configurations people are running.  We will
use this information to improve device driver support in future releases.
(We would be much happier if this information was for the supplied GENERIC
kernel; not for a custom compiled kernel).  The device driver information
we get from this helps us fix existing drivers.
</pre>

<p>
Make sure you send email from an account that is able to also receive
email so developers can contact you back if they have something they
want you to test or change in order to get your setup working. It's not
important at all to send the email from the same machine that is running
OpenBSD, so if that machine is unable to receive email, just

<pre>
$ dmesg | mail your-account@yourmail.dom
</pre>
and then forward that message to
<pre>
 dmesg@openbsd.org
</pre>
where <tt>your-account@yourmail.dom</tt> is your regular email account.
(or transfer the dmesg output using ftp/scp/floppydisk/carrier-pigeon/...)

<p>
<strong>NOTE</strong> - Please send only GENERIC kernel dmesgs. Custom
kernels that have device drivers removed are not helpful.

<a name="AddFileSet"></a>
<h2>4.8 - Adding a file set after install</h2>
<!-- XXXversion -->
"Oh no!  I forgot to add a file set when I did the install!"
<p>
Sometimes, you realize you really DID need <tt>comp33.tgz</tt> (or any
other system component) after all, but you didn't realize this at the
time you installed your system.  Good news: There are two easy ways to
add file sets after the initial install:

<h3>Using the Upgrade process</h3>
Simply boot your install media (CD-ROM or Floppy), and choose Upgrade
(rather than Install).  When you get to the lists of file sets to
install, choose the sets you neglected to install first time around,
select your source, and let it install them for you.

<h3>Using tar(1)</h3>
The install file sets are simply compressed tar files, and you can
expand them manually from the root of the filesystem:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # cd /
  # tar xzvpf comp33.tgz
</pre></td></tr></table>

<p>
Do NOT forget the <tt>'p'</tt> option in the above command in
order to restore the file permissions properly!
<p>
One common mistake is to think you can use
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1">pkg_add(1)</a>
to add a missing file sets.  This does not work.  pgk_add(1) is
for package files, not generic tar files like the install sets.


<a name="bsd.rd"></a>
<h2>4.9 - What is 'bsd.rd'?</h2>

<b><tt>bsd.rd</tt></b> is a "RAM Disk" kernel.  This file can be very 
useful; many developers are careful to keep it on the root of their
system at all times.

<p>
Calling it a "RAM Disk kernel" describes the root filesystem of the
kernel -- rather than being a physical drive, the utilities available
after the boot of <tt>bsd.rd</tt> are stored in the kernel, and are run
from a RAM-based filesystem.  <tt>bsd.rd</tt> also includes a healthy set
of utilities to allow you to do system maintenance and installation.

<p>
On some platforms, <tt>bsd.rd</tt> is actually the preferred 
installation technique -- you place this kernel on an existing 
filesystem, boot it, and run the install from it.  On most 
platforms, if you have a running older version of OpenBSD, you 
can FTP  a new version of <tt>bsd.rd</tt>, reboot from it, and 
install a new version of OpenBSD without using any removable 
media at all.

<p>
Here is an example of booting <tt>bsd.rd</tt> on an i386 system:

<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Using Drive: 0 Partition: 3
  reading boot.....
  probing pc0 com0 com1 apm mem[639k 255M a20=on]
  disk fd0 hd0
  &gt;&gt; OpenBSD/i386 BOOT 1.29
  boot&gt; <b>boot hd0a:/bsd.rd</b>
<i>. . . normal boot to install . . .</i>
</pre></td></tr></table>

As indicated, you will be brought to the install program, but you
can also drop to the shell to do maintenance on your system.
<p>
The general rule on booting <tt>bsd.rd</tt> is to change your boot
kernel from <tt>/bsd</tt> to <tt>bsd.rd</tt> through whatever 
means used on your platform.  
<p>
<br>

<a name="InstProb"></a>
<h2>4.10 - Common Installation Problems</h2>

<a name="mkdevhang"></a>
<h3>4.10.1 - Install hangs during MAKEDEV</h3>
Usually, this is caused by a lack of physical RAM in the system.
See <a href="#SmallRAM">here</a>.

<a name="cpq16m"></a>
<h3>4.10.2 - My Compaq only recognizes 16M RAM</h3>
<i>Some</i> Compaq systems have an issue where the full system RAM is
not detected by the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">OpenBSD
second stage boot loader</a> properly, and only 16M may be detected
and used by OpenBSD. This can be corrected either by creating/editing
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot.conf&amp;sektion=8&amp;arch=i386"><tt>/etc/boot.conf</tt></a>
file, or by entering commands at the "<tt>boot></tt>" prompt before
OpenBSD loads.  If you had a machine with 64M RAM, but OpenBSD was only
detecting the first 16M, the command you would use would be:

<pre>
     machine mem +0x3000000@0x1000000
</pre>
to add 48M (<tt>0x3000000</tt>) after the first 16M
(<tt>0x1000000</tt>).  Typically, if you had a machine with this
problem, you would enter the above command first at the install
floppy/CDROM's <tt>boot></tt> prompt, load the system, reboot, and
create a <tt>/etc/boot.conf</tt> file with the above line in it so all
future bootings will recognize all available RAM.

<p>
It has also been reported that a ROM update will fix this on <i>some</i>
systems.

<a name="noboot"></a>
<h3>4.10.3 - My i386 won't boot after install</h3>
Your install seemed to go fine, but on first boot, you see no sign of
OpenBSD attempting to boot.  There are a few common reasons for this
problem:

<ul>
<li><b>No partition was flagged active in fdisk(8).</b>  To fix this,
reboot the machine using the boot floppy or media, and "flag" a 
partition as "active" (bootable).  See 
<a href="faq14.html#fdisk">here</a> and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">here</a>

<li><b>No valid boot loader was ever put on the disk.</b>
If you answer "Y" to the "Use entire disk for OpenBSD?" question during
the install, or use the "<tt>reinit</tt>" option of fdisk(8), the
OpenBSD boot record is installed on the Master Boot Record of the disk;
otherwise, the existing master boot code is untouched.  This will be a
problem if no other boot record existed.  The solution is to boot the
install media again, drop to the shell and invoke
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>
and use the "<tt>update</tt>" option.  

<li><b>In some rare occasions, something may go wrong with the second
stage boot loader install.</b>  Reinstalling the second stage boot
loader is discussed <a href="faq14.html#InstBoot">here</a>.

<li><b>You mixed <i>a.out</i> and <i>ELF</i> boot disk and install
files.</b>  OpenBSD/i386 has transitioned from the older <i>a.out</i>
format to the <i>ELF</i> format for binaries after 3.3-release.  The
<a href="faq5.html#Flavors">3.3-current snapshot's</a>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot
loader</a> can not boot an OpenBSD 3.3-release's kernel, nor can the
3.3-release boot loader boot a <i>-current</i> kernel.  You must use a
boot disk that matches the version of OpenBSD you intend to install.
Failure to follow this will show itself with a message such as
"<tt>failure(79)</tt>" and/or "<tt>Inappropriate file type or
format</tt>".

<li><b>You ignored all the <a href="#Disks">warnings</a> and
<a href="#SpaceNeeded">explanations</a> about the
<a href="faq14.html#LargeDrive">8G boot limit</a>.</b>  This
results in a hang at the very start of the boot process, sometimes with
the message, "<tt>Bad magic</tt>".

</ul>

<a name="sshhang"></a>
<h3>4.10.4 - My (older, slower) machine booted, but hung at the ssh-keygen
steps</h3>
It is very likely your machine is running fine, just taking a while
to do the ssh key generation process.  A SparcStation2 or a Macintosh
Quadra may take 45 minutes or more to complete the three
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a>
steps, some machines will take even longer.  Just let it finish; it is
only done once per install.

<a name="noftplist"></a>
<h3>4.10.5 - I got the message "ftplist: No such file" when doing an
install</h3>

When doing an FTP install of a 
<a href="upgrade-minifaq.html#1.1">snapshot</a> during the <i>-beta</i>
stage of the <a href="faq5.html#Flavors">OpenBSD development cycle</a>,
you may see this:

<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>

  Do you want to see a list of potential FTP servers?  [y] <i>ENTER</i>
  grep: /tmp/ftplist: No such file or directory
  Server IP address or hostname? 
</pre></td></tr></table>

This is normal and expected behavior during this pre-release part of the
cycle.  The install program looks for the FTP list on the primary FTP
server in a directory that won't be available until the
<a href="faq1.html#Next">release date</a>, so you get the above message.

<p>
Simply use the <a href="../ftp.html">FTP mirror list</a> to find your
favorite FTP mirror, and manually enter its name when prompted.

<p>
<b>Note: You should not see this if you are installing <i>-release</i>
or from CDROM.</b>

<a name="site"></a>
<h2>4.11 - Customizing the Install Process</h2>
<!-- XXXversion -->

<h3><tt>siteXX.tgz</tt> file</h3>
The OpenBSD install/upgrade scripts allow the selection of a
user-created set called "<tt>siteXX.tgz</tt>", where XX is the release
version (e.g. 33).  The <tt>siteXX.tgz</tt> file set is, like the other
<a href="#FilesNeeded">file sets</a>, a
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gzip&amp;sektion=1">gzip(1)</a>
compressed
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
archive rooted in '/' and is un-tarred like the other sets with the
options <tt>xzpf</tt>.  This set will be installed last, after
all other file sets.

<p>
This file set allows the user to add to and/or override the files
installed in the 'normal' sets and thus customize the installation or
upgrade.

<p>
Some example uses of a <tt>siteXX.tgz</tt> file:
<ul>
<li>Create a siteXX.tgz file that contains all the file changes you made
since first installing OpenBSD. Then, if you have to re-create the
system you simply select siteXX.tgz during the re-install and all of
your changes are replicated on the new system.

<li>Create a series of machine specific directories that each contain a
siteXX.tgz file that contains files specific to those machine types.
Installation of machines (e.g. boxes with different graphics cards) of a
particular category can be completed by selecting the appropriate
siteXX.tgz file.

<li>Put the files you routinely customize in a same or similar way
in a siteXX.tgz file --
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8"
><tt>/etc/skel</tt></a> files,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5"
><tt>/etc/pf.conf</tt></a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8"
><tt>/var/www/conf/httpd.conf</tt></a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=5"
><tt>/etc/rc.conf</tt></a>,
etc. 
</ul>

<h3><tt>install.site</tt>/<tt>upgrade.site</tt> scripts</h3>
As the last step in the install/upgrade process, the scripts look in the
root directory of the newly installed/upgraded system for
<tt>install.site</tt> or <tt>upgrade.site</tt>, as appropriate to the
current process, and runs this script in an environment
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=8">chroot</a>ed
to the installed/upgraded system's root.  Remember, the upgrade is done
from a booted file system, so your target file system is actually
mounted on <tt>/mnt</tt>.  However, your script can be written as if it
it is running in the "normal" root of your file system.  Since this
script is run after all the files are installed, you have almost full
functionality of your system (though, in single user mode) when your
script runs.

<p>
Note that the <tt>install.site</tt> script would have to be in a
<tt>siteXX.tgz file</tt>, while the <tt>upgrade.site</tt> script could
be put in the root directory before the upgrade, or could be put in a
<tt>siteXX.tgz</tt> file.

<p>
The scripts can be used to do anything possible in a script.
<ul>
<li>Remove files that are installed/upgraded that you don't want present
on the system.
<li> Remove/upgrade/install the
<a href="faq8.html#Packages">packages</a> you want on the installed
system.
<li> Do an <a href="faq14.html#Backup">immediate backup/archive</a> of
the new system before you expose it to the rest of the world.
</ul>

The combination of <tt>siteXX.tgz</tt> and
<tt>install.site/upgrade.site</tt> files is intended to give the user
broad customization capabilities without having to build their own
custom install sets.

<a name="Multiple"></a>
<h2>4.12 - How can I load a number of similar systems?</h2>
Here are some tools you can use when you have to deploy a number 
of similar OpenBSD systems.

<h3><tt>siteXX.tgz</tt> and <tt>install/upgrade.site</tt> files</h3>
See the <a href="#site">above</a> article.

<h3>Restore from Dump</h3>
On most platforms, the boot media includes the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>
program, which can be used to restore a backup made by 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a>.
Thus, you could boot from a 
<a href="#MkFlop">floppy</a>, 
<a href="../orders.html">CD</a>, or
<a href="#bsd.rd">bsd.rd</a> file, then
<a href="faq14.html#fdisk">fdisk</a>,
<a href="faq14.html#disklabel">disklabel</a>, and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore</a>
the desired configuration from tape or other media, and install the
<a href="faq14.html#InstBoot">boot blocks</a>. More details 
<a href="faq14.html#Backup">here</a>.

<h3>Disk Imaging</h3>
Unfortunately, there are no known disk imaging packages which are
FFS-aware and can make an image containing only the active file space.
Most of the major disk imaging solutions will treat an OpenBSD partition
as a "generic" partition, and can make an image of the whole disk. This
often accomplishes your goal, but usually with huge amounts of wasted
space --  an empty, 10G <tt>/home</tt> partition will require 10G of
space in the image, even if there isn't a single file in it.  While you
can typically install a drive image to a larger drive, you would not be
able to directly use the extra space, and you would not be able to
install an image to a smaller drive.

<p>
If this is an acceptable situation, you may find the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd</a>
command will do what you need, allowing you to copy one disk to another,
sector-for-sector.  This would provide the same functionality as
commercial programs without the cost.

<a name="getdmesg"></a>
<h2>4.13 - How can I get a dmesg(8) to report an install problem?</h2>
When <a href="../report.html">reporting a problem</a>, it is critical to
include the complete system
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>.
However, often when you need to do this, it is because the system is
working improperly or won't install so you may not have disk, network,
or other resources you need to get the dmesg to the appropriate
<a href="../mail.html">mail list</a>.  There are other ways, however:

<ul>
<li><b>Floppy disk:</b>  The boot disks and CDROM has enough tools
to let you record your dmesg to an MSDOS floppy disk for reading on
another machine.  Place an MSDOS formatted floppy in your disk drive and
execute the following commands:

<pre>
     mount -t msdos /dev/fd0a /mnt
     dmesg >/mnt/dmesg.txt
     umount /mnt
</pre>
If you have another OpenBSD system, you can also write it to an OpenBSD
compatible floppy -- often, the boot floppy has enough room on it to
hold the dmesg.  In that case, leave off the "<tt>-t msdos</tt>" above.

<p>
<li><b>Serial Console:</b> See <a href="faq7.html#SerCon">this article</a>
on setting up the serial console, then capture the output to a file.

<p>
<li><b>FTP:</b>  Under some circumstances, you may be able to use the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1">ftp(1)</a>
client on the boot disk or CDROM to send the dmesg to a local FTP
server, where you can retrieve it later.
</ul>

<p>

<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq3.html">[To Section 3 - Obtaining OpenBSD]</a>
<a href= "faq5.html">[To Section 5 - Building the System from Source]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt= "[back]"></a> 
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>Originally [OpenBSD: faq4.html,v 1.140 ]</small><br>
<small>
$RuOBSD: faq4.html,v 1.6 2003/06/06 09:02:38 cruz Exp $<br>
$Translation$<br>
$OpenBSD$
</small>

</body>
</html>
